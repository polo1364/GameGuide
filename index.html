<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameMaster æ”»ç•¥å¤§å¸« | éŠæˆ²æ”»ç•¥ç”Ÿæˆå™¨</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Noto+Sans+TC:wght@300;400;500;600;700&family=MedievalSharp&display=swap" rel="stylesheet">
    <style>
        :root {
            --sheikah-blue: #5bcefa;
            --sheikah-glow: #00d4aa;
            --triforce-gold: #d4a430;
            --heart-red: #e85454;
            --ancient-orange: #f5a623;
            --hyrule-green: #4a7c59;
            --bg-parchment: #f4e8d3;
            --bg-dark: #2d2416;
            --bg-card: rgba(244, 232, 211, 0.95);
            --bg-card-dark: rgba(45, 36, 22, 0.9);
            --text-dark: #3d2e1c;
            --text-light: #f4e8d3;
            --border-ancient: rgba(212, 164, 48, 0.5);
            --shadow-sheikah: 0 0 20px rgba(91, 206, 250, 0.3);
            --shadow-soft: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: linear-gradient(180deg, #87ceeb 0%, #98d4e8 30%, #c5e8d5 60%, #e8f0e0 100%);
            min-height: 100vh;
            color: var(--text-dark);
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 5 L35 25 L55 30 L35 35 L30 55 L25 35 L5 30 L25 25 Z' fill='none' stroke='%23d4a43020' stroke-width='1'/%3E%3C/svg%3E");
            opacity: 0.5;
            pointer-events: none;
            z-index: 0;
        }

        /* Hyrule Background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
            overflow: hidden;
        }

        .bg-animation::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40%;
            background: linear-gradient(180deg, transparent 0%, rgba(74, 124, 89, 0.2) 50%, rgba(74, 124, 89, 0.4) 100%);
        }

        .bg-animation::after {
            content: 'â–²';
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2rem;
            color: var(--triforce-gold);
            opacity: 0.3;
            text-shadow: 0 0 20px var(--triforce-gold);
            animation: triforceGlow 4s ease-in-out infinite;
        }

        @keyframes triforceGlow {
            0%, 100% { opacity: 0.2; text-shadow: 0 0 20px var(--triforce-gold); }
            50% { opacity: 0.5; text-shadow: 0 0 40px var(--triforce-gold), 0 0 60px var(--triforce-gold); }
        }

        .grid-overlay {
            display: none;
        }

        /* Main Container */
        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header */
        header {
            text-align: center;
            padding: 3rem 0 2rem;
            animation: fadeInDown 0.8s ease-out;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            font-family: 'Cinzel', serif;
            font-size: 2.8rem;
            font-weight: 700;
            color: var(--text-dark);
            letter-spacing: 0.15em;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 0 rgba(255,255,255,0.5);
            position: relative;
        }

        .logo::before {
            content: 'âš”ï¸';
            position: absolute;
            left: -50px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5rem;
        }

        .logo::after {
            content: 'ğŸ›¡ï¸';
            position: absolute;
            right: -50px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5rem;
        }

        .tagline {
            font-family: 'MedievalSharp', cursive;
            font-size: 1.1rem;
            color: var(--hyrule-green);
            letter-spacing: 0.2em;
        }

        /* Settings Button */
        .settings-btn {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--bg-card);
            border: 3px solid var(--triforce-gold);
            color: var(--triforce-gold);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 100;
            box-shadow: var(--shadow-soft);
        }

        .settings-btn:hover {
            background: var(--triforce-gold);
            color: var(--bg-dark);
            transform: rotate(90deg) scale(1.1);
        }

        .settings-btn svg {
            width: 24px;
            height: 24px;
        }

        /* Animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Input Section */
        .input-section {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 2.5rem;
            margin: 2rem 0;
            border: 3px solid var(--border-ancient);
            animation: fadeInUp 0.8s ease-out 0.4s both;
            box-shadow: var(--shadow-soft);
            position: relative;
        }

        .input-section::before {
            content: 'â—†';
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-parchment);
            padding: 0 1rem;
            color: var(--triforce-gold);
            font-size: 1rem;
        }

        .input-group {
            margin-bottom: 2rem;
        }

        .input-group:last-of-type {
            margin-bottom: 0;
        }

        .input-label {
            display: block;
            font-family: 'Cinzel', serif;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.8rem;
            letter-spacing: 0.05em;
        }

        .input-field {
            width: 100%;
            padding: 1rem 1.5rem;
            font-size: 1rem;
            font-family: 'Noto Sans TC', sans-serif;
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid var(--border-ancient);
            border-radius: 8px;
            color: var(--text-dark);
            transition: all 0.3s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--triforce-gold);
            box-shadow: 0 0 15px rgba(212, 164, 48, 0.3);
            background: rgba(255, 255, 255, 0.95);
        }

        .input-field::placeholder {
            color: #8b7355;
        }

        textarea.input-field {
            min-height: 150px;
            resize: vertical;
        }

        /* Generate Button */
        .generate-btn {
            width: 100%;
            padding: 1.2rem 2rem;
            font-family: 'Cinzel', serif;
            font-size: 1.2rem;
            font-weight: 700;
            letter-spacing: 0.1em;
            color: #fff;
            background: linear-gradient(135deg, var(--hyrule-green) 0%, #2d5a3d 100%);
            border: 3px solid var(--triforce-gold);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.4s ease;
            margin-top: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-soft);
        }

        .generate-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(212, 164, 48, 0.3), transparent);
            transition: left 0.5s ease;
        }

        .generate-btn:hover::before {
            left: 100%;
        }

        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(74, 124, 89, 0.4);
            background: linear-gradient(135deg, #5a8c6a 0%, var(--hyrule-green) 100%);
        }

        .generate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .generate-btn.loading {
            pointer-events: none;
        }

        .generate-btn.loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid transparent;
            border-top-color: var(--triforce-gold);
            border-radius: 50%;
            margin-left: 1rem;
            animation: spin 1s linear infinite;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Result Section */
        .result-section {
            margin-top: 3rem;
            animation: fadeInUp 0.6s ease-out;
        }

        .result-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 2.5rem;
            border: 3px solid var(--border-ancient);
            position: relative;
            box-shadow: var(--shadow-soft);
        }

        .result-card::before {
            content: 'ğŸ“œ';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.5rem;
            background: var(--bg-parchment);
            padding: 0 0.5rem;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--border-ancient);
        }

        .result-title {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-dark);
        }

        .result-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.85rem;
            color: #8b7355;
            flex-wrap: wrap;
        }

        .result-badge {
            padding: 0.4rem 1rem;
            background: rgba(212, 164, 48, 0.15);
            border-radius: 20px;
            border: 1px solid var(--border-ancient);
            color: var(--text-dark);
        }

        .result-content {
            line-height: 1.9;
            color: var(--text-dark);
        }

        .result-content h1,
        .result-content h2,
        .result-content h3 {
            font-family: 'Cinzel', serif;
            color: var(--hyrule-green);
            margin: 2rem 0 1rem;
        }

        .result-content h1 { font-size: 1.8rem; }
        .result-content h2 { font-size: 1.4rem; border-bottom: 2px solid var(--border-ancient); padding-bottom: 0.5rem; }
        .result-content h3 { font-size: 1.2rem; }

        .result-content p {
            margin-bottom: 1rem;
        }

        .result-content ul,
        .result-content ol {
            margin: 1rem 0;
            padding-left: 2rem;
        }

        .result-content li {
            margin-bottom: 0.5rem;
        }

        .result-content li::marker {
            color: var(--triforce-gold);
        }

        .result-content code {
            background: rgba(212, 164, 48, 0.15);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            color: #5a4a3a;
        }

        .result-content pre {
            background: rgba(45, 36, 22, 0.9);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1.5rem 0;
            border: 2px solid var(--border-ancient);
            color: var(--bg-parchment);
        }

        .result-content pre code {
            background: transparent;
            padding: 0;
            color: var(--bg-parchment);
        }

        .result-content blockquote {
            border-left: 4px solid var(--triforce-gold);
            padding-left: 1.5rem;
            margin: 1.5rem 0;
            font-style: italic;
            color: #6a5a4a;
            background: rgba(212, 164, 48, 0.08);
            padding: 1rem 1.5rem;
            border-radius: 0 8px 8px 0;
        }

        .result-content strong {
            color: var(--hyrule-green);
            font-weight: 700;
        }

        /* ç¾è§€è¡¨æ ¼æ¨£å¼ */
        .result-content table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 2rem 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1), 0 0 0 1px var(--border-ancient);
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.9), rgba(244, 232, 211, 0.9));
        }

        .result-content thead {
            background: linear-gradient(135deg, var(--hyrule-green) 0%, #3a6349 100%);
        }

        .result-content th {
            padding: 1rem 1.2rem;
            text-align: left;
            color: var(--text-light);
            font-family: 'Cinzel', serif;
            font-weight: 600;
            font-size: 0.95rem;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            border: none;
            position: relative;
        }

        .result-content th::after {
            content: '';
            position: absolute;
            right: 0;
            top: 25%;
            height: 50%;
            width: 1px;
            background: rgba(255, 255, 255, 0.2);
        }

        .result-content th:last-child::after {
            display: none;
        }

        .result-content td {
            padding: 1rem 1.2rem;
            text-align: left;
            border: none;
            border-bottom: 1px solid rgba(212, 164, 48, 0.2);
            vertical-align: top;
            transition: all 0.2s ease;
        }

        .result-content tbody tr {
            background: rgba(255, 255, 255, 0.6);
            transition: all 0.3s ease;
        }

        .result-content tbody tr:nth-child(even) {
            background: rgba(244, 232, 211, 0.6);
        }

        .result-content tbody tr:hover {
            background: rgba(212, 164, 48, 0.15);
            transform: scale(1.005);
        }

        .result-content tbody tr:last-child td {
            border-bottom: none;
        }

        .result-content tbody tr:last-child td:first-child {
            border-bottom-left-radius: 12px;
        }

        .result-content tbody tr:last-child td:last-child {
            border-bottom-right-radius: 12px;
        }

        /* è¡¨æ ¼ç¬¬ä¸€æ¬„å¼·èª¿ */
        .result-content td:first-child {
            font-weight: 600;
            color: var(--hyrule-green);
        }

        /* è¡¨æ ¼éŸ¿æ‡‰å¼ */
        @media (max-width: 768px) {
            .result-content table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
            
            .result-content th,
            .result-content td {
                padding: 0.8rem;
                font-size: 0.9rem;
            }
        }

        /* æ•¸æ“šè¡¨æ ¼ç‰¹æ®Šæ¨£å¼ */
        .result-content table.data-table td:not(:first-child) {
            text-align: center;
        }

        /* è¡¨æ ¼å…§çš„ç‰¹æ®Šæ¨™è¨˜ */
        .result-content td code {
            background: rgba(74, 124, 89, 0.15);
            color: var(--hyrule-green);
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            font-size: 0.85em;
        }

        /* è¡¨æ ¼æ¨™é¡Œè£é£¾ */
        .table-wrapper {
            position: relative;
            margin: 2rem 0;
        }

        .table-wrapper::before {
            content: 'ğŸ“Š';
            position: absolute;
            top: -12px;
            left: 20px;
            font-size: 1.2rem;
            background: var(--bg-parchment);
            padding: 0 0.5rem;
            z-index: 1;
        }

        /* è¡¨æ ¼å…§ç‰¹æ®Šå…ƒç´ æ¨£å¼ */
        .table-number {
            font-family: 'Cinzel', serif;
            font-weight: 700;
            color: var(--ancient-orange);
            background: rgba(245, 166, 35, 0.1);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .table-check {
            color: #2ecc71;
            font-size: 1.2em;
        }

        .table-cross {
            color: var(--heart-red);
            font-size: 1.2em;
        }

        .table-stars {
            color: var(--triforce-gold);
            letter-spacing: 2px;
            text-shadow: 0 0 5px rgba(212, 164, 48, 0.5);
        }

        .table-stars-empty {
            color: #ccc;
            letter-spacing: 2px;
        }

        /* è³‡è¨Šå¡ç‰‡æ¨£å¼ */
        .result-content .info-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(244, 232, 211, 0.95));
            border: 2px solid var(--border-ancient);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .result-content .info-card::before {
            content: 'ğŸ’¡';
            position: absolute;
            top: -10px;
            left: 20px;
            background: var(--bg-parchment);
            padding: 0 0.5rem;
        }

        /* è­¦å‘Š/æç¤ºå€å¡Š */
        .result-content .tip-block {
            background: linear-gradient(135deg, rgba(91, 206, 250, 0.1), rgba(0, 212, 170, 0.1));
            border-left: 4px solid var(--sheikah-blue);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 8px 8px 0;
        }

        .result-content .warning-block {
            background: linear-gradient(135deg, rgba(245, 166, 35, 0.1), rgba(232, 84, 84, 0.1));
            border-left: 4px solid var(--ancient-orange);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 8px 8px 0;
        }

        /* æ­¥é©Ÿåˆ—è¡¨ç‰¹æ®Šæ¨£å¼ */
        .result-content ol {
            counter-reset: step-counter;
            list-style: none;
            padding-left: 0;
        }

        .result-content ol > li {
            counter-increment: step-counter;
            position: relative;
            padding-left: 3.5rem;
            margin-bottom: 1.2rem;
            min-height: 2.5rem;
        }

        .result-content ol > li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            width: 2.2rem;
            height: 2.2rem;
            background: linear-gradient(135deg, var(--hyrule-green), #3a6349);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cinzel', serif;
            font-weight: 700;
            font-size: 0.9rem;
            box-shadow: 0 2px 8px rgba(74, 124, 89, 0.3);
        }

        /* åˆ†éš”ç·šæ¨£å¼ */
        .result-content hr {
            border: none;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--border-ancient), transparent);
            margin: 2rem 0;
        }

        /* é€£çµæ¨£å¼ */
        .result-content a {
            color: var(--sheikah-blue);
            text-decoration: none;
            border-bottom: 1px dashed var(--sheikah-blue);
            transition: all 0.3s ease;
        }

        .result-content a:hover {
            color: var(--sheikah-glow);
            border-bottom-style: solid;
        }

        /* æ¨™ç±¤/å¾½ç« æ¨£å¼ */
        .result-content .badge {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            background: linear-gradient(135deg, var(--hyrule-green), #3a6349);
            color: white;
            border-radius: 12px;
            font-size: 0.8em;
            margin: 0 0.2rem;
        }

        .result-content .badge-gold {
            background: linear-gradient(135deg, var(--triforce-gold), #c49420);
        }

        .result-content .badge-red {
            background: linear-gradient(135deg, var(--heart-red), #c94444);
        }

        .result-content .badge-blue {
            background: linear-gradient(135deg, var(--sheikah-blue), #4ab8e8);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(45, 36, 22, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 3rem;
            max-width: 500px;
            width: 90%;
            border: 3px solid var(--triforce-gold);
            box-shadow: 0 0 40px rgba(212, 164, 48, 0.3);
            transform: scale(0.9) translateY(20px);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .modal-overlay.active .modal {
            transform: scale(1) translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .modal-title {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-dark);
        }

        .modal-close {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: transparent;
            border: 2px solid var(--border-ancient);
            color: #8b7355;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 1.5rem;
        }

        .modal-close:hover {
            background: rgba(232, 84, 84, 0.2);
            border-color: var(--heart-red);
            color: var(--heart-red);
        }

        .api-info {
            background: rgba(212, 164, 48, 0.15);
            border: 2px solid var(--border-ancient);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            color: var(--text-dark);
        }

        .api-info a {
            color: var(--hyrule-green);
            text-decoration: none;
            font-weight: 600;
        }

        .api-info a:hover {
            text-decoration: underline;
        }

        .save-btn {
            width: 100%;
            padding: 1rem;
            font-family: 'Cinzel', serif;
            font-size: 1rem;
            font-weight: 600;
            color: #fff;
            background: linear-gradient(135deg, var(--triforce-gold), #b8860b);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1.5rem;
        }

        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(212, 164, 48, 0.4);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(244, 232, 211, 0.5);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--triforce-gold);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #b8860b;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 3rem 0;
            color: #6a5a4a;
            font-size: 0.9rem;
        }

        footer a {
            color: var(--hyrule-green);
            text-decoration: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .logo {
                font-size: 2.2rem;
            }

            .tagline {
                font-size: 0.85rem;
                letter-spacing: 0.2em;
            }

            .input-section {
                padding: 1.5rem;
            }

            .result-card {
                padding: 1.5rem;
            }

            .modal {
                padding: 2rem;
            }
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--bg-card);
            border: 2px solid var(--triforce-gold);
            border-radius: 8px;
            padding: 1rem 2rem;
            color: var(--text-dark);
            box-shadow: var(--shadow-soft);
            z-index: 2000;
            opacity: 0;
            transition: all 0.4s ease;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .toast.error {
            border-color: var(--heart-red);
            box-shadow: 0 0 20px rgba(232, 84, 84, 0.3);
        }

        /* Typing Effect */
        .typing-cursor {
            display: inline-block;
            width: 3px;
            height: 1.2em;
            background: var(--primary-cyan);
            margin-left: 2px;
            animation: blink 1s infinite;
            vertical-align: text-bottom;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /* Copy Button */
        .copy-btn {
            padding: 0.6rem 1.2rem;
            background: rgba(212, 164, 48, 0.1);
            border: 1px solid var(--border-ancient);
            border-radius: 6px;
            color: var(--text-dark);
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .copy-btn:hover {
            background: rgba(212, 164, 48, 0.2);
            border-color: var(--triforce-gold);
        }

        .copy-btn svg {
            width: 16px;
            height: 16px;
        }

        /* Sources Section */
        .sources-section {
            margin-top: 2.5rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--border-ancient);
        }

        .sources-section h3 {
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            color: var(--text-dark);
            margin-bottom: 1rem;
        }

        .sources-list {
            list-style: none;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
        }

        .sources-list li {
            margin: 0;
        }

        .sources-list a {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: rgba(74, 124, 89, 0.1);
            border: 1px solid rgba(74, 124, 89, 0.4);
            border-radius: 6px;
            color: var(--hyrule-green);
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            max-width: 300px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .sources-list a:hover {
            background: rgba(74, 124, 89, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(74, 124, 89, 0.2);
        }

        /* Verified Badge */
        .verified-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.3rem 0.8rem;
            background: rgba(74, 124, 89, 0.15);
            border: 1px solid rgba(74, 124, 89, 0.4);
            border-radius: 20px;
            color: var(--hyrule-green);
            font-size: 0.8rem;
            margin-left: 0.5rem;
        }

        /* Quick Templates */
        .quick-templates {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
            margin-top: 0.8rem;
        }

        .quick-template-btn {
            padding: 0.5rem 1rem;
            background: rgba(74, 124, 89, 0.1);
            border: 1px solid rgba(74, 124, 89, 0.4);
            border-radius: 6px;
            color: var(--hyrule-green);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quick-template-btn:hover {
            background: rgba(74, 124, 89, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(74, 124, 89, 0.2);
        }

        /* Popular Games */
        .popular-games {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
            margin-top: 0.8rem;
        }

        /* è‡ªå‹•åµæ¸¬å¹³å°é¡¯ç¤º */
        .detected-platform {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
            padding: 0.8rem 1.2rem;
            background: linear-gradient(135deg, rgba(91, 206, 250, 0.15), rgba(0, 212, 170, 0.15));
            border: 2px solid var(--sheikah-blue);
            border-radius: 10px;
            animation: platformDetected 0.5s ease;
        }

        @keyframes platformDetected {
            0% { opacity: 0; transform: translateY(-10px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .detected-label {
            color: var(--text-dark);
            font-size: 0.9rem;
        }

        .detected-value {
            font-weight: 700;
            color: var(--hyrule-green);
            font-size: 1rem;
            padding: 0.3rem 0.8rem;
            background: rgba(74, 124, 89, 0.15);
            border-radius: 6px;
        }

        .popular-game-btn {
            padding: 0.5rem 1rem;
            background: rgba(212, 164, 48, 0.1);
            border: 1px solid var(--border-ancient);
            border-radius: 6px;
            color: var(--text-dark);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .popular-game-btn:hover {
            background: rgba(212, 164, 48, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(212, 164, 48, 0.2);
            border-color: var(--triforce-gold);
        }

        /* Game Autocomplete */
        .autocomplete-wrapper {
            position: relative;
        }

        .autocomplete-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border: 2px solid var(--triforce-gold);
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 50;
            display: none;
            box-shadow: var(--shadow-soft);
        }

        .autocomplete-list.active {
            display: block;
            animation: slideDown 0.2s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .autocomplete-item {
            padding: 0.8rem 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            border-bottom: 1px solid var(--border-ancient);
            transition: all 0.2s ease;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .autocomplete-item:hover,
        .autocomplete-item.selected {
            background: rgba(212, 164, 48, 0.15);
        }

        .autocomplete-item .game-icon {
            font-size: 1.3rem;
        }

        .autocomplete-item .game-info {
            flex: 1;
        }

        .autocomplete-item .game-name {
            color: var(--text-dark);
            font-weight: 500;
        }

        .autocomplete-item .game-name .highlight {
            color: var(--hyrule-green);
            font-weight: 700;
        }

        .autocomplete-item .game-platform {
            font-size: 0.75rem;
            color: #8b7355;
            margin-top: 0.2rem;
        }

        .autocomplete-hint {
            padding: 0.6rem 1.2rem;
            font-size: 0.8rem;
            color: #8b7355;
            background: rgba(212, 164, 48, 0.1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .autocomplete-hint kbd {
            padding: 0.2rem 0.5rem;
            background: rgba(212, 164, 48, 0.2);
            border-radius: 4px;
            font-size: 0.75rem;
            color: var(--text-dark);
        }

        .wiki-badge {
            display: inline-block;
            padding: 0.1rem 0.4rem;
            background: rgba(74, 124, 89, 0.1);
            border: 1px solid rgba(74, 124, 89, 0.3);
            border-radius: 4px;
            font-size: 0.7rem;
            color: var(--hyrule-green);
            margin-left: 0.5rem;
        }

        /* Font Size Controls */
        .font-controls {
            position: fixed;
            top: 1.5rem;
            right: 5rem;
            display: flex;
            gap: 0.5rem;
            z-index: 100;
        }

        .font-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-card);
            border: 2px solid var(--border-ancient);
            color: var(--text-dark);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-weight: bold;
            font-size: 1rem;
            box-shadow: var(--shadow-soft);
        }

        .font-btn:hover {
            background: var(--triforce-gold);
            color: #fff;
            border-color: var(--triforce-gold);
        }

        /* Follow-up Section */
        .followup-section {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px dashed var(--border-ancient);
        }

        .followup-container {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
        }

        .followup-input {
            flex: 1;
            padding: 1rem 1.5rem;
            font-size: 1rem;
            font-family: 'Noto Sans TC', sans-serif;
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid var(--border-ancient);
            border-radius: 8px;
            color: var(--text-dark);
            transition: all 0.3s ease;
            min-height: 60px;
            resize: vertical;
        }

        .followup-input:focus {
            outline: none;
            border-color: var(--triforce-gold);
            box-shadow: 0 0 15px rgba(212, 164, 48, 0.2);
            background: rgba(255, 255, 255, 0.95);
        }

        .followup-input::placeholder {
            color: #8b7355;
        }

        .followup-btn {
            padding: 1rem 1.5rem;
            font-family: 'Cinzel', serif;
            font-size: 0.9rem;
            font-weight: 600;
            color: #fff;
            background: linear-gradient(135deg, var(--triforce-gold), #b8860b);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .followup-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(212, 164, 48, 0.4);
        }

        .followup-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .followup-label {
            font-family: 'Cinzel', serif;
            font-size: 0.95rem;
            color: var(--text-dark);
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Conversation History */
        .conversation-divider {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 2rem 0;
            color: #8b7355;
            font-size: 0.85rem;
        }

        .conversation-divider::before,
        .conversation-divider::after {
            content: '';
            flex: 1;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--border-ancient), transparent);
        }

        .question-badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            background: rgba(212, 164, 48, 0.15);
            border: 1px solid var(--border-ancient);
            border-radius: 6px;
            color: var(--text-dark);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        /* Font size variations */
        .font-small .result-content { font-size: 0.9rem; line-height: 1.7; }
        .font-medium .result-content { font-size: 1rem; line-height: 1.9; }
        .font-large .result-content { font-size: 1.15rem; line-height: 2; }
        .font-xlarge .result-content { font-size: 1.3rem; line-height: 2.1; }

        @media (max-width: 768px) {
            .font-controls {
                top: auto;
                bottom: 1.5rem;
                right: 1rem;
            }

            .followup-container {
                flex-direction: column;
            }

            .followup-btn {
                width: 100%;
            }

            .quick-templates,
            .popular-games {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Background Animation -->
    <div class="bg-animation">
        <div class="grid-overlay"></div>
    </div>

    <!-- Font Size Controls -->
    <div class="font-controls">
        <button class="font-btn" onclick="changeFontSize(-1)" title="ç¸®å°å­—é«”">A-</button>
        <button class="font-btn" onclick="changeFontSize(1)" title="æ”¾å¤§å­—é«”">A+</button>
    </div>

    <!-- Settings Button -->
    <button class="settings-btn" onclick="openModal()" title="API è¨­å®š">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
        </svg>
    </button>

    <div class="container">
        <!-- Header -->
        <header>
            <h1 class="logo">æµ·æ‹‰é­¯æ”»ç•¥æ›¸</h1>
            <p class="tagline">~ å‹‡è€…çš„æ™ºæ…§æŒ‡å— ~</p>
        </header>

        <!-- Input Section -->
        <section class="input-section">
            <div class="input-group">
                <label class="input-label" for="gameName">éŠæˆ²åç¨± <span style="font-size: 0.8rem; color: var(--text-secondary);">ï¼ˆè¼¸å…¥é—œéµå­—è‡ªå‹•æœå°‹ï¼‰</span></label>
                <div class="autocomplete-wrapper">
                    <input type="text" id="gameName" class="input-field" placeholder="ä¾‹å¦‚ï¼šè–©çˆ¾é”ã€è‰¾çˆ¾ç™»ã€FFã€é­”ç‰©çµäºº..." autocomplete="off">
                    <div class="autocomplete-list" id="autocompleteList">
                        <div class="autocomplete-hint">
                            <span>ğŸ’¡ ä½¿ç”¨ <kbd>â†‘</kbd> <kbd>â†“</kbd> é¸æ“‡ï¼Œ<kbd>Enter</kbd> ç¢ºèª</span>
                        </div>
                    </div>
                </div>
                <div class="popular-games">
                    <span style="color: var(--text-secondary); font-size: 0.85rem; margin-right: 0.5rem;">ç†±é–€ï¼š</span>
                    <button class="popular-game-btn" onclick="selectGame('è–©çˆ¾é”å‚³èªª ç‹åœ‹ä¹‹æ·š')">è–©çˆ¾é”å‚³èªª ç‹åœ‹ä¹‹æ·š</button>
                    <button class="popular-game-btn" onclick="selectGame('è‰¾çˆ¾ç™»æ³•ç’°')">è‰¾çˆ¾ç™»æ³•ç’°</button>
                    <button class="popular-game-btn" onclick="selectGame('Final Fantasy XVI')">FF16</button>
                    <button class="popular-game-btn" onclick="selectGame('é­”ç‰©çµäºº è’é‡')">é­”ç‰©çµäºº è’é‡</button>
                    <button class="popular-game-btn" onclick="selectGame('åŸç¥')">åŸç¥</button>
                    <button class="popular-game-btn" onclick="selectGame('è–©çˆ¾é”å‚³èªª æ› é‡ä¹‹æ¯')">æ› é‡ä¹‹æ¯</button>
                    <button class="popular-game-btn" onclick="selectGame('é»‘ç¥è©±ï¼šæ‚Ÿç©º')">é»‘ç¥è©±ï¼šæ‚Ÿç©º</button>
                    <button class="popular-game-btn" onclick="selectGame('æ–¯æ™®æ‹‰é3')">æ–¯æ™®æ‹‰é3</button>
                </div>
                <!-- è‡ªå‹•åµæ¸¬å¹³å°é¡¯ç¤º -->
                <div class="detected-platform" id="detectedPlatformDisplay" style="display: none;">
                    <span class="detected-label">ğŸ¯ åµæ¸¬åˆ°çš„å¹³å°ï¼š</span>
                    <span class="detected-value" id="detectedPlatformText"></span>
                </div>
            </div>
            <div class="input-group">
                <label class="input-label" for="question">æ‚¨çš„å•é¡Œ</label>
                <textarea id="question" class="input-field" placeholder="è«‹æè¿°æ‚¨æƒ³äº†è§£çš„æ”»ç•¥å…§å®¹ï¼Œä¾‹å¦‚ï¼š&#10;â€¢ å¦‚ä½•æ“Šæ•—æŸå€‹ Bossï¼Ÿ&#10;â€¢ æŸå€‹ä»»å‹™çš„å®Œæ•´æµç¨‹æ˜¯ä»€éº¼ï¼Ÿ&#10;â€¢ éš±è—é“å…·åœ¨å“ªè£¡ï¼Ÿ&#10;â€¢ æœ€ä½³è§’è‰²é…ç½®å»ºè­°ï¼Ÿ"></textarea>
                <div class="quick-templates">
                    <span style="color: var(--text-secondary); font-size: 0.85rem; margin-right: 0.5rem;">å¿«é€Ÿå•é¡Œï¼š</span>
                    <button class="quick-template-btn" onclick="selectTemplate('boss')">ğŸ—¡ï¸ Boss æ”»ç•¥</button>
                    <button class="quick-template-btn" onclick="selectTemplate('hidden')">ğŸ” éš±è—è¦ç´ </button>
                    <button class="quick-template-btn" onclick="selectTemplate('build')">âš”ï¸ æœ€å¼·é…è£</button>
                    <button class="quick-template-btn" onclick="selectTemplate('quest')">ğŸ“œ ä»»å‹™æµç¨‹</button>
                    <button class="quick-template-btn" onclick="selectTemplate('tips')">ğŸ’¡ æ–°æ‰‹æŒ‡å—</button>
                    <button class="quick-template-btn" onclick="selectTemplate('ending')">ğŸ† å…¨çµå±€æ”»ç•¥</button>
                </div>
            </div>
            <button class="generate-btn" id="generateBtn" onclick="generateGuide()">
                âš¡ ç”Ÿæˆæ”»ç•¥
            </button>
        </section>

        <!-- Result Section -->
        <section class="result-section" id="resultSection" style="display: none;">
            <div class="result-card font-medium" id="resultCard">
                <div class="result-header">
                    <h3 class="result-title" id="resultTitle">æ”»ç•¥å…§å®¹</h3>
                    <div class="result-meta">
                        <span class="result-badge" id="resultPlatform"></span>
                        <span class="verified-badge" id="verifiedBadge" style="display: none;">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                            </svg>
                            å·²åƒè€ƒç¶²è·¯è³‡æ–™
                        </span>
                        <button class="copy-btn" onclick="copyResult()">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                            </svg>
                            è¤‡è£½
                        </button>
                    </div>
                </div>
                <div class="result-content" id="resultContent"></div>
                
                <!-- Follow-up Section -->
                <div class="followup-section">
                    <div class="followup-label">
                        ğŸ’¬ é‡å°æ­¤æ”»ç•¥ç¹¼çºŒè¿½å•
                    </div>
                    <div class="followup-container">
                        <textarea id="followupInput" class="followup-input" placeholder="ä¾‹å¦‚ï¼šé€™å€‹ Boss æœ‰ä»€éº¼å¼±é»ï¼Ÿç¬¬ä¸‰éšæ®µè¦æ€éº¼èº²é¿ï¼Ÿæœ‰æ²’æœ‰æ›´ç°¡å–®çš„æ–¹æ³•ï¼Ÿ"></textarea>
                        <button class="followup-btn" id="followupBtn" onclick="askFollowup()">
                            ğŸ”„ è¿½å•
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <p>âœ¦ ç”± <strong>Gemini</strong> é­”æ³•é©…å‹• âœ¦ æ”»ç•¥å…§å®¹åƒ…ä¾›åƒè€ƒ</p>
        </footer>
    </div>

    <!-- API Key Modal -->
    <div class="modal-overlay" id="apiModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ” API è¨­å®š</h3>
                <button class="modal-close" onclick="closeModal()">Ã—</button>
            </div>
            <div class="api-info">
                ğŸ’¡ è«‹è¼¸å…¥æ‚¨çš„ Gemini API Keyã€‚<br>
                å¯åœ¨ <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a> å…è²»å–å¾—ã€‚
            </div>
            <div class="input-group">
                <label class="input-label" for="apiKey">Gemini API Key</label>
                <input type="password" id="apiKey" class="input-field" placeholder="è¼¸å…¥æ‚¨çš„ API Key...">
            </div>
            <button class="save-btn" onclick="saveApiKey()">ğŸ’¾ å„²å­˜è¨­å®š</button>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <script>
        // State
        let detectedPlatform = null;
        let detectedPlatformRaw = null;
        let apiKey = localStorage.getItem('gemini_api_key') || '';
        let conversationHistory = [];
        let currentGameName = '';
        let currentPlatform = '';
        let fontSizeLevel = 1; // 0=small, 1=medium, 2=large, 3=xlarge
        const fontSizeClasses = ['font-small', 'font-medium', 'font-large', 'font-xlarge'];

        // Platform names mapping
        const platformNames = {
            'switch': 'Nintendo Switch',
            'pc': 'PC',
            'ps5': 'PlayStation 5',
            'ps4': 'PlayStation 4',
            'xbox-series': 'Xbox Series X|S',
            'xbox-one': 'Xbox One',
            '3ds': 'Nintendo 3DS',
            'ios': 'iOS (iPhone/iPad)',
            'android': 'Android',
            'steam-deck': 'Steam Deck',
            'retro': 'ç¶“å…¸ä¸»æ©Ÿ'
        };

        // Game Database for autocomplete (loaded from JSON)
        let gameDatabase = [];
        
        // Load game database from JSON file
        async function loadGameDatabase() {
            try {
                const response = await fetch('games.json');
                if (response.ok) {
                    const data = await response.json();
                    gameDatabase = data.games || [];
                    console.log(`âœ… å·²è¼‰å…¥ ${gameDatabase.length} æ¬¾éŠæˆ²è³‡æ–™`);
                } else {
                    console.warn('ç„¡æ³•è¼‰å…¥ games.jsonï¼Œä½¿ç”¨å…§å»ºè³‡æ–™åº«');
                    loadFallbackDatabase();
                }
            } catch (error) {
                console.warn('è¼‰å…¥ games.json å¤±æ•—ï¼Œä½¿ç”¨å…§å»ºè³‡æ–™åº«:', error);
                loadFallbackDatabase();
            }
        }
        
        // Fallback database if JSON fails to load
        function loadFallbackDatabase() {
            gameDatabase = [
            // Nintendo Switch
            { name: 'è–©çˆ¾é”å‚³èªª ç‹åœ‹ä¹‹æ·š', alias: ['zelda', 'totk', 'ç‹æ·š', 'tears of the kingdom'], platform: 'Switch', icon: 'ğŸ—¡ï¸' },
            { name: 'è–©çˆ¾é”å‚³èªª æ› é‡ä¹‹æ¯', alias: ['zelda', 'botw', 'æ› é‡', 'breath of the wild'], platform: 'Switch', icon: 'ğŸ¹' },
            { name: 'æ–¯æ™®æ‹‰é3', alias: ['splatoon', 'æ¼†å½ˆ', 'å™´å™´'], platform: 'Switch', icon: 'ğŸ¦‘' },
            { name: 'å‹•ç‰©æ£®å‹æœƒ', alias: ['animal crossing', 'å‹•æ£®', 'acnh'], platform: 'Switch', icon: 'ğŸï¸' },
            { name: 'å¯¶å¯å¤¢ æœ±ï¼ç´«', alias: ['pokemon', 'å¯¶å¯å¤¢', 'æœ±ç´«', 'scarlet', 'violet', 'sv'], platform: 'Switch', icon: 'âš¡' },
            { name: 'å¯¶å¯å¤¢ æœ±ï¼ç´« é›¶ä¹‹ç§˜å¯¶', alias: ['pokemon', 'é›¶ä¹‹ç§˜å¯¶', 'dlc', 'ç¢§ä¹‹å‡é¢', 'è—ä¹‹åœ“ç›¤'], platform: 'Switch', icon: 'ğŸ’' },
            { name: 'å¯¶å¯å¤¢å‚³èªª é˜¿çˆ¾å®™æ–¯', alias: ['pokemon', 'arceus', 'é˜¿çˆ¾å®™æ–¯', 'legends arceus', 'pla'], platform: 'Switch', icon: 'ğŸŒŸ' },
            { name: 'å¯¶å¯å¤¢å‚³èªª Z-A', alias: ['pokemon', 'legends za', 'z-a', 'å‚³èªªza'], platform: 'Switch', icon: 'âœ¨' },
            { name: 'å¯¶å¯å¤¢ æ™¶ç‡¦é‘½çŸ³ï¼æ˜äº®çç ', alias: ['pokemon', 'bdsp', 'é‘½çŸ³', 'çç ', 'brilliant diamond', 'shining pearl'], platform: 'Switch', icon: 'ğŸ’' },
            { name: 'å¯¶å¯å¤¢ åŠï¼ç›¾', alias: ['pokemon', 'sword', 'shield', 'åŠç›¾', 'swsh'], platform: 'Switch', icon: 'ğŸ—¡ï¸' },
            { name: 'å¯¶å¯å¤¢ åŠï¼ç›¾ æ“´å……ç¥¨', alias: ['pokemon', 'é§ä¹‹å­¤å³¶', 'å† ä¹‹é›ªåŸ', 'dlc', 'expansion'], platform: 'Switch', icon: 'ğŸï¸' },
            { name: 'å¯¶å¯å¤¢ Let\'s Goï¼çš®å¡ä¸˜ï¼ä¼Šå¸ƒ', alias: ['pokemon', 'lets go', 'çš®å¡ä¸˜', 'ä¼Šå¸ƒ', 'lgpe'], platform: 'Switch', icon: 'âš¡' },
            { name: 'New å¯¶å¯å¤¢éš¨æ¨‚æ‹', alias: ['pokemon', 'snap', 'éš¨æ¨‚æ‹', 'new pokemon snap'], platform: 'Switch', icon: 'ğŸ“¸' },
            { name: 'å¯¶å¯å¤¢ä¸å¯æ€è­°è¿·å®® æ•‘é›£éšŠDX', alias: ['pokemon', 'mystery dungeon', 'ä¸å¯æ€è­°è¿·å®®', 'æ•‘é›£éšŠ'], platform: 'Switch', icon: 'ğŸŒ€' },
            { name: 'å¯¶å¯å¤¢å¤§é›†çµ', alias: ['pokemon', 'unite', 'å¤§é›†çµ', 'moba'], platform: 'Switch/Mobile', icon: 'ğŸŸï¸' },
            { name: 'å¯¶å¯å¤¢Sleep', alias: ['pokemon', 'sleep', 'ç¡çœ '], platform: 'Mobile', icon: 'ğŸ˜´' },
            { name: 'å¯¶å¯å¤¢GO', alias: ['pokemon', 'go', 'pogo'], platform: 'Mobile', icon: 'ğŸš¶' },
            { name: 'PokÃ©mon HOME', alias: ['pokemon', 'home', 'å¯¶å¯å¤¢home'], platform: 'Switch/Mobile', icon: 'ğŸ ' },
            { name: 'å¯¶å¯å¤¢ ç©¶æ¥µä¹‹æ—¥ï¼ç©¶æ¥µä¹‹æœˆ', alias: ['pokemon', 'ultra sun', 'ultra moon', 'ç©¶æ¥µæ—¥æœˆ', 'usum'], platform: '3DS', icon: 'ğŸŒ™' },
            { name: 'å¯¶å¯å¤¢ å¤ªé™½ï¼æœˆäº®', alias: ['pokemon', 'sun', 'moon', 'æ—¥æœˆ', 'sm'], platform: '3DS', icon: 'â˜€ï¸' },
            { name: 'å¯¶å¯å¤¢ çµ‚æ¥µç´…å¯¶çŸ³ï¼å§‹æºè—å¯¶çŸ³', alias: ['pokemon', 'omega ruby', 'alpha sapphire', 'oras'], platform: '3DS', icon: 'ğŸ’' },
            { name: 'å¯¶å¯å¤¢ Xï¼Y', alias: ['pokemon', 'xy', 'x y'], platform: '3DS', icon: 'ğŸ¦Œ' },
            { name: 'å¯¶å¯å¤¢ é»‘2ï¼ç™½2', alias: ['pokemon', 'black 2', 'white 2', 'b2w2', 'é»‘ç™½2'], platform: 'DS', icon: 'âš«' },
            { name: 'å¯¶å¯å¤¢ é»‘ï¼ç™½', alias: ['pokemon', 'black', 'white', 'bw', 'é»‘ç™½'], platform: 'DS', icon: 'âšª' },
            { name: 'å¯¶å¯å¤¢ å¿ƒé‡‘ï¼é­‚éŠ€', alias: ['pokemon', 'heartgold', 'soulsilver', 'hgss', 'å¿ƒé‡‘é­‚éŠ€'], platform: 'DS', icon: 'ğŸ’›' },
            { name: 'å¯¶å¯å¤¢ é‘½çŸ³ï¼çç ', alias: ['pokemon', 'diamond', 'pearl', 'dp', 'é‘½ç'], platform: 'DS', icon: 'ğŸ’ ' },
            { name: 'å¯¶å¯å¤¢ ç™½é‡‘', alias: ['pokemon', 'platinum', 'ç™½é‡‘', 'pt'], platform: 'DS', icon: 'ğŸ”˜' },
            { name: 'å¯¶å¯å¤¢ ç«ç´…ï¼è‘‰ç¶ ', alias: ['pokemon', 'firered', 'leafgreen', 'frlg', 'ç«ç´…è‘‰ç¶ '], platform: 'GBA', icon: 'ğŸ”¥' },
            { name: 'å¯¶å¯å¤¢ ç´…å¯¶çŸ³ï¼è—å¯¶çŸ³', alias: ['pokemon', 'ruby', 'sapphire', 'rse', 'ç´…è—å¯¶çŸ³'], platform: 'GBA', icon: 'ğŸ’' },
            { name: 'å¯¶å¯å¤¢ ç¶ å¯¶çŸ³', alias: ['pokemon', 'emerald', 'ç¶ å¯¶çŸ³'], platform: 'GBA', icon: 'ğŸ’š' },
            { name: 'å¯¶å¯å¤¢ é‡‘ï¼éŠ€ï¼æ°´æ™¶', alias: ['pokemon', 'gold', 'silver', 'crystal', 'gsc', 'é‡‘éŠ€æ°´æ™¶'], platform: 'GB/GBC', icon: 'ğŸ¥‡' },
            { name: 'å¯¶å¯å¤¢ ç´…ï¼è—ï¼é»ƒ', alias: ['pokemon', 'red', 'blue', 'yellow', 'rby', 'ç´…è—é»ƒ', 'çš®å¡ä¸˜ç‰ˆ'], platform: 'GB', icon: 'ğŸ”´' },
            
            // æ´›å…‹äººç³»åˆ—
            { name: 'æ´›å…‹äºº11 å‘½é‹çš„é½’è¼ª', alias: ['rockman', 'mega man', 'megaman', 'æ´›å…‹äºº11', 'rockman 11'], platform: 'Switch/PS4/PC', icon: 'ğŸ¤–' },
            { name: 'æ´›å…‹äººX é€±å¹´ç´€å¿µåˆé›†', alias: ['rockman x', 'mega man x', 'megaman x', 'æ´›å…‹äººx', 'anniversary collection'], platform: 'Switch/PS4/PC', icon: 'âš”ï¸' },
            { name: 'æ´›å…‹äººX é€±å¹´ç´€å¿µåˆé›†2', alias: ['rockman x', 'mega man x', 'megaman x', 'æ´›å…‹äººx', 'collection 2'], platform: 'Switch/PS4/PC', icon: 'âš”ï¸' },
            { name: 'æ´›å…‹äºº ç¶“å…¸åˆé›†', alias: ['rockman', 'mega man', 'megaman', 'æ´›å…‹äºº', 'legacy collection'], platform: 'Switch/PS4/PC', icon: 'ğŸ®' },
            { name: 'æ´›å…‹äºº ç¶“å…¸åˆé›†2', alias: ['rockman', 'mega man', 'megaman', 'æ´›å…‹äºº', 'legacy collection 2'], platform: 'Switch/PS4/PC', icon: 'ğŸ®' },
            { name: 'æ´›å…‹äººZero/ZX ç¶“å…¸åˆé›†', alias: ['rockman zero', 'mega man zero', 'zx', 'æ´›å…‹äººzero', 'å‚‘æ´›'], platform: 'Switch/PS4/PC', icon: 'ğŸ”´' },
            { name: 'æ´›å…‹äººEXE åˆé›†', alias: ['rockman exe', 'mega man battle network', 'æ´›å…‹äººexe', 'battle network', 'bn'], platform: 'Switch/PS4/PC', icon: 'ğŸ’»' },
            { name: 'æ´›å…‹äººX DiVE', alias: ['rockman x dive', 'mega man x dive', 'æ´›å…‹äººx dive'], platform: 'Mobile/PC', icon: 'ğŸ“±' },
            { name: 'æ´›å…‹äºº11', alias: ['rockman 11', 'mega man 11', 'æ´›å…‹äºº11'], platform: 'Switch/PS4/PC', icon: 'ğŸ¤–' },
            { name: 'æ´›å…‹äºº10', alias: ['rockman 10', 'mega man 10', 'æ´›å…‹äºº10'], platform: 'PS3/Wii/PC', icon: 'ğŸ¤–' },
            { name: 'æ´›å…‹äºº9', alias: ['rockman 9', 'mega man 9', 'æ´›å…‹äºº9'], platform: 'PS3/Wii', icon: 'ğŸ¤–' },
            { name: 'æ´›å…‹äººX8', alias: ['rockman x8', 'mega man x8', 'æ´›å…‹äººx8'], platform: 'PS2/PC', icon: 'âš”ï¸' },
            { name: 'æ´›å…‹äººX7', alias: ['rockman x7', 'mega man x7', 'æ´›å…‹äººx7'], platform: 'PS2/PC', icon: 'âš”ï¸' },
            { name: 'æ´›å…‹äººX6', alias: ['rockman x6', 'mega man x6', 'æ´›å…‹äººx6'], platform: 'PS1/PC', icon: 'âš”ï¸' },
            { name: 'æ´›å…‹äººX5', alias: ['rockman x5', 'mega man x5', 'æ´›å…‹äººx5'], platform: 'PS1/PC', icon: 'âš”ï¸' },
            { name: 'æ´›å…‹äººX4', alias: ['rockman x4', 'mega man x4', 'æ´›å…‹äººx4'], platform: 'PS1/PC', icon: 'âš”ï¸' },
            { name: 'æ´›å…‹äººX3', alias: ['rockman x3', 'mega man x3', 'æ´›å…‹äººx3'], platform: 'SFC/PS1', icon: 'âš”ï¸' },
            { name: 'æ´›å…‹äººX2', alias: ['rockman x2', 'mega man x2', 'æ´›å…‹äººx2'], platform: 'SFC', icon: 'âš”ï¸' },
            { name: 'æ´›å…‹äººX', alias: ['rockman x', 'mega man x', 'æ´›å…‹äººx', 'x1'], platform: 'SFC', icon: 'âš”ï¸' },
            { name: 'æ´›å…‹äººZero 4', alias: ['rockman zero 4', 'mega man zero 4', 'æ´›å…‹äººzero4', 'å‚‘æ´›4'], platform: 'GBA', icon: 'ğŸ”´' },
            { name: 'æ´›å…‹äººZero 3', alias: ['rockman zero 3', 'mega man zero 3', 'æ´›å…‹äººzero3', 'å‚‘æ´›3'], platform: 'GBA', icon: 'ğŸ”´' },
            { name: 'æ´›å…‹äººZero 2', alias: ['rockman zero 2', 'mega man zero 2', 'æ´›å…‹äººzero2', 'å‚‘æ´›2'], platform: 'GBA', icon: 'ğŸ”´' },
            { name: 'æ´›å…‹äººZero', alias: ['rockman zero', 'mega man zero', 'æ´›å…‹äººzero', 'å‚‘æ´›'], platform: 'GBA', icon: 'ğŸ”´' },
            { name: 'æ´›å…‹äººZX', alias: ['rockman zx', 'mega man zx', 'æ´›å…‹äººzx'], platform: 'DS', icon: 'ğŸ’ ' },
            { name: 'æ´›å…‹äººZX Advent', alias: ['rockman zx advent', 'mega man zx advent', 'æ´›å…‹äººzx advent'], platform: 'DS', icon: 'ğŸ’ ' },
            { name: 'æ´›å…‹äººEXE 6', alias: ['rockman exe 6', 'mega man battle network 6', 'æ´›å…‹äººexe6', 'bn6'], platform: 'GBA', icon: 'ğŸ’»' },
            { name: 'æ´›å…‹äººEXE 5', alias: ['rockman exe 5', 'mega man battle network 5', 'æ´›å…‹äººexe5', 'bn5'], platform: 'GBA/DS', icon: 'ğŸ’»' },
            { name: 'æ´›å…‹äººEXE 4', alias: ['rockman exe 4', 'mega man battle network 4', 'æ´›å…‹äººexe4', 'bn4'], platform: 'GBA', icon: 'ğŸ’»' },
            { name: 'æ´›å…‹äººEXE 3', alias: ['rockman exe 3', 'mega man battle network 3', 'æ´›å…‹äººexe3', 'bn3'], platform: 'GBA', icon: 'ğŸ’»' },
            { name: 'æ´›å…‹äººEXE 2', alias: ['rockman exe 2', 'mega man battle network 2', 'æ´›å…‹äººexe2', 'bn2'], platform: 'GBA', icon: 'ğŸ’»' },
            { name: 'æ´›å…‹äººEXE', alias: ['rockman exe', 'mega man battle network', 'æ´›å…‹äººexe', 'bn1'], platform: 'GBA', icon: 'ğŸ’»' },
            { name: 'æµæ˜Ÿæ´›å…‹äºº3', alias: ['ryuusei no rockman', 'mega man star force 3', 'æµæ˜Ÿæ´›å…‹äºº3', 'star force 3'], platform: 'DS', icon: 'â­' },
            { name: 'æµæ˜Ÿæ´›å…‹äºº2', alias: ['ryuusei no rockman', 'mega man star force 2', 'æµæ˜Ÿæ´›å…‹äºº2', 'star force 2'], platform: 'DS', icon: 'â­' },
            { name: 'æµæ˜Ÿæ´›å…‹äºº', alias: ['ryuusei no rockman', 'mega man star force', 'æµæ˜Ÿæ´›å…‹äºº', 'star force'], platform: 'DS', icon: 'â­' },
            { name: 'æ´›å…‹äººå‚³å¥‡', alias: ['rockman dash', 'mega man legends', 'æ´›å…‹äººdash', 'legends'], platform: 'PS1', icon: 'ğŸŒ' },
            { name: 'æ´›å…‹äººå‚³å¥‡2', alias: ['rockman dash 2', 'mega man legends 2', 'æ´›å…‹äººdash2', 'legends 2'], platform: 'PS1', icon: 'ğŸŒ' },
            
            // ç‚¸å½ˆè¶…äººç³»åˆ—
            { name: 'è¶…ç´šç‚¸å½ˆè¶…äººR Online', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'super bomberman r online'], platform: 'Switch/PS4/PC', icon: 'ğŸ’£' },
            { name: 'è¶…ç´šç‚¸å½ˆè¶…äººR', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'super bomberman r'], platform: 'Switch/PS4/PC', icon: 'ğŸ’£' },
            { name: 'è¶…ç´šç‚¸å½ˆè¶…äººR 2', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'super bomberman r 2', 'r2'], platform: 'Switch/PS5/PC', icon: 'ğŸ’£' },
            { name: 'ç‚¸å½ˆè¶…äºº äº‚æˆ°å°æ±º', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'battle royale'], platform: 'Switch/PS4', icon: 'ğŸ’¥' },
            { name: 'å°æˆ°ç‚¸å½ˆè¶…äºº', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'taisen'], platform: 'Arcade', icon: 'ğŸ’£' },
            { name: 'ç‚¸å½ˆè¶…äºº64', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'bomberman 64'], platform: 'N64', icon: 'ğŸ’£' },
            { name: 'ç‚¸å½ˆè¶…äºº å‚‘ä¹™å¤ªå‚³èªª', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'jetters', 'å‚‘ä¹™å¤ª'], platform: 'GC/PS2', icon: 'ğŸš€' },
            { name: 'ç‚¸å½ˆè¶…äºº è‹±é›„', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'hero', 'è‹±é›„'], platform: 'PS2', icon: 'ğŸ’£' },
            { name: 'ç‚¸å½ˆè¶…äºº å¤§é™¸', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'land', 'å¤§é™¸'], platform: 'Wii', icon: 'ğŸŒ' },
            { name: 'ç‚¸å½ˆè¶…äºº æ”»æ“Š', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'blast'], platform: 'PS3/360', icon: 'ğŸ’¥' },
            { name: 'ç‚¸å½ˆè¶…äºº Live', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'live'], platform: 'Xbox360', icon: 'ğŸ’£' },
            { name: 'è¶…ç´šç‚¸å½ˆè¶…äºº', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'super bomberman'], platform: 'SFC', icon: 'ğŸ’£' },
            { name: 'è¶…ç´šç‚¸å½ˆè¶…äºº2', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'super bomberman 2'], platform: 'SFC', icon: 'ğŸ’£' },
            { name: 'è¶…ç´šç‚¸å½ˆè¶…äºº3', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'super bomberman 3'], platform: 'SFC', icon: 'ğŸ’£' },
            { name: 'è¶…ç´šç‚¸å½ˆè¶…äºº4', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'super bomberman 4'], platform: 'SFC', icon: 'ğŸ’£' },
            { name: 'è¶…ç´šç‚¸å½ˆè¶…äºº5', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'super bomberman 5'], platform: 'SFC', icon: 'ğŸ’£' },
            { name: 'ç‚¸å½ˆè¶…äºº ä¸–ä»£', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'generation'], platform: 'PS2/PSP', icon: 'ğŸ’£' },
            { name: 'ç‚¸å½ˆè¶…äºº æ”œå¸¶ç‰ˆ', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'portable'], platform: 'PSP', icon: 'ğŸ’£' },
            { name: 'ç‚¸å½ˆè¶…äºº æ•…äº‹', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'story'], platform: 'PS1/Saturn', icon: 'ğŸ“–' },
            { name: 'ç‚¸å½ˆè¶…äºº ä¸–ç•Œ', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'world'], platform: 'PC-Engine', icon: 'ğŸŒ' },
            { name: 'ç‚¸å½ˆè¶…äºº 94', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'bomberman 94'], platform: 'PC-Engine', icon: 'ğŸ’£' },
            { name: 'ç‚¸å½ˆè¶…äºº 93', alias: ['bomberman', 'ç‚¸å½ˆäºº', 'ç‚¸å½ˆè¶…äºº', 'bomberman 93'], platform: 'PC-Engine', icon: 'ğŸ’£' },
            { name: 'è¶…ç´šç‘ªåˆ©æ­å…„å¼Ÿ é©šå¥‡', alias: ['mario', 'wonder', 'ç‘ªåˆ©æ­', 'é©šå¥‡'], platform: 'Switch', icon: 'ğŸ„' },
            { name: 'è¶…ç´šç‘ªåˆ©æ­ å¥§å¾·è³½', alias: ['mario', 'odyssey', 'å¥§å¾·è³½'], platform: 'Switch', icon: 'ğŸ©' },
            { name: 'ç«ç„°ä¹‹ç´‹ç«  Engage', alias: ['fire emblem', 'fe', 'ç«ç´‹'], platform: 'Switch', icon: 'âš”ï¸' },
            { name: 'ç•°åº¦ç¥åŠ3', alias: ['xenoblade', 'ç•°åº¦ç¥åŠ', 'xc3'], platform: 'Switch', icon: 'ğŸ”®' },
            { name: 'ç‘ªåˆ©æ­è³½è»Š8 è±ªè¯ç‰ˆ', alias: ['mario kart', 'mk8', 'ç‘ªè»Š'], platform: 'Switch', icon: 'ğŸï¸' },
            { name: 'ä»»å¤©å ‚æ˜æ˜Ÿå¤§äº‚é¬¥ ç‰¹åˆ¥ç‰ˆ', alias: ['smash', 'å¤§äº‚é¬¥', 'ssbu'], platform: 'Switch', icon: 'ğŸ‘Š' },
            { name: 'è–©çˆ¾é”å‚³èªª ç¹”å¤¢å³¶', alias: ['zelda', 'link awakening', 'ç¹”å¤¢å³¶'], platform: 'Switch', icon: 'ğŸŒŠ' },
            { name: 'è·¯æ˜“å‰æ´‹æ¨“3', alias: ['luigi mansion', 'è·¯æ˜“å‰', 'æ´‹æ¨“'], platform: 'Switch', icon: 'ğŸ‘»' },
            { name: 'æ˜Ÿä¹‹å¡æ¯” æ¢ç´¢ç™¼ç¾', alias: ['kirby', 'å¡æ¯”', 'forgotten land'], platform: 'Switch', icon: 'â­' },
            { name: 'çš®å…‹æ•4', alias: ['pikmin', 'çš®å…‹æ•'], platform: 'Switch', icon: 'ğŸŒ±' },
            { name: 'å¥‡å¹»ç”Ÿæ´»iï¼šè½‰åœˆåœˆçš„é¾å’Œå·å–æ™‚é–“çš„å°‘å¥³', alias: ['fantasy life', 'å¥‡å¹»ç”Ÿæ´»', 'fantasy life i', 'è½‰åœˆåœˆçš„é¾', 'å·å–æ™‚é–“'], platform: 'Switch', icon: 'ğŸ‰' },
            { name: 'ç‰§å ´ç‰©èª Welcomeï¼ç¾éº—äººç”Ÿ', alias: ['harvest moon', 'story of seasons', 'ç‰§å ´ç‰©èª', 'ç¾éº—äººç”Ÿ'], platform: 'Switch', icon: 'ğŸŒ¾' },
            { name: 'ç¬¦æ–‡å·¥å» 5', alias: ['rune factory', 'ç¬¦æ–‡å·¥å» ', 'rf5'], platform: 'Switch', icon: 'âš”ï¸' },
            { name: 'å¤©ç©—ä¹‹å’²ç¨»å§¬', alias: ['sakuna', 'å¤©ç©—', 'å’²ç¨»å§¬', 'rice and ruin'], platform: 'Switch/PS4/PC', icon: 'ğŸŒ¾' },
            { name: 'å“†å•¦Aå¤¢ ç‰§å ´ç‰©èª', alias: ['doraemon', 'å“†å•¦Aå¤¢', 'ç‰§å ´ç‰©èª'], platform: 'Switch', icon: 'ğŸ¤–' },
            { name: 'é›†åˆå•¦ï¼å‹•ç‰©æ£®å‹æœƒ', alias: ['animal crossing', 'å‹•æ£®', 'acnh', 'é›†åˆå•¦'], platform: 'Switch', icon: 'ğŸï¸' },
            { name: 'Rune Factory 4 Special', alias: ['rune factory 4', 'ç¬¦æ–‡å·¥å» 4', 'rf4'], platform: 'Switch', icon: 'ğŸŒ¸' },
            
            // PlayStation
            { name: 'Final Fantasy XVI', alias: ['ff16', 'ff 16', 'final fantasy', 'æœ€çµ‚å¹»æƒ³16'], platform: 'PS5', icon: 'ğŸ”¥' },
            { name: 'Final Fantasy VII é‡ç”Ÿ', alias: ['ff7', 'rebirth', 'final fantasy 7', 'é‡ç”Ÿ'], platform: 'PS5', icon: 'âš”ï¸' },
            { name: 'Final Fantasy VII é‡è£½ç‰ˆ', alias: ['ff7', 'remake', 'final fantasy 7', 'é‡è£½'], platform: 'PS5/PS4', icon: 'ğŸŒƒ' },
            { name: 'æˆ°ç¥ è«¸ç¥é»ƒæ˜', alias: ['god of war', 'ragnarok', 'gow', 'æˆ°ç¥'], platform: 'PS5/PS4', icon: 'ğŸª“' },
            { name: 'åœ°å¹³ç·š è¥¿æ–¹ç¦åœ°', alias: ['horizon', 'forbidden west', 'åœ°å¹³ç·š'], platform: 'PS5/PS4', icon: 'ğŸ¦–' },
            { name: 'åœ°å¹³ç·š é›¶ä¹‹æ›™å…‰', alias: ['horizon', 'zero dawn', 'åœ°å¹³ç·š'], platform: 'PS4/PC', icon: 'ğŸŒ…' },
            { name: 'æ¼«å¨èœ˜è››äºº2', alias: ['spider-man', 'spiderman', 'èœ˜è››äºº'], platform: 'PS5', icon: 'ğŸ•·ï¸' },
            { name: 'æ¼«å¨èœ˜è››äºº', alias: ['spider-man', 'spiderman', 'èœ˜è››äºº'], platform: 'PS4/PC', icon: 'ğŸ•¸ï¸' },
            { name: 'æœ€å¾Œç”Ÿé‚„è€… Part I', alias: ['last of us', 'tlou', 'æœ€å¾Œç”Ÿé‚„è€…'], platform: 'PS5/PC', icon: 'ğŸ„' },
            { name: 'æœ€å¾Œç”Ÿé‚„è€… Part II', alias: ['last of us', 'tlou2', 'æœ€å¾Œç”Ÿé‚„è€…2'], platform: 'PS5/PS4', icon: 'ğŸ¦‹' },
            { name: 'å°é¦¬æˆ°é¬¼', alias: ['ghost of tsushima', 'got', 'å°é¦¬'], platform: 'PS5/PS4/PC', icon: 'ğŸƒ' },
            { name: 'æ­»äº¡æ“±æ·º', alias: ['death stranding', 'æ­»äº¡æ“±æ·º'], platform: 'PS5/PS4/PC', icon: 'ğŸ“¦' },
            { name: 'è¡€æºè©›å’’', alias: ['bloodborne', 'è¡€æº'], platform: 'PS4', icon: 'ğŸ©¸' },
            { name: 'æƒ¡é­”éˆé­‚', alias: ['demon souls', 'æƒ¡é­”éˆé­‚'], platform: 'PS5', icon: 'ğŸ‘¹' },
            { name: 'Stellar Blade', alias: ['stellar blade', 'æ˜Ÿåˆƒ'], platform: 'PS5', icon: 'âœ¨' },
            { name: 'äººä¸­ä¹‹é¾8', alias: ['yakuza', 'like a dragon', 'äººé¾', 'å¦‚é¾'], platform: 'PS5/PS4', icon: 'ğŸ‰' },
            { name: 'äººä¸­ä¹‹é¾ ç„¡é™è²¡å¯Œ', alias: ['yakuza', 'like a dragon', 'äººé¾', 'ç„¡é™è²¡å¯Œ'], platform: 'PS5', icon: 'ğŸ’' },
            
            // Multi-platform / PC
            { name: 'è‰¾çˆ¾ç™»æ³•ç’°', alias: ['elden ring', 'er', 'æ³•ç’°', 'è€é ­ç’°'], platform: 'PC/PS5/PS4', icon: 'ğŸ’' },
            { name: 'è‰¾çˆ¾ç™»æ³•ç’° é»ƒé‡‘æ¨¹å¹½å½±', alias: ['elden ring', 'shadow of erdtree', 'dlc', 'é»ƒé‡‘æ¨¹'], platform: 'PC/PS5/PS4', icon: 'ğŸŒ³' },
            { name: 'é»‘ç¥è©±ï¼šæ‚Ÿç©º', alias: ['black myth', 'wukong', 'æ‚Ÿç©º', 'é»‘ç¥è©±'], platform: 'PC/PS5', icon: 'ğŸ’' },
            { name: 'éš»ç‹¼ï¼šæš—å½±é›™æ­»', alias: ['sekiro', 'éš»ç‹¼', 'shadows die twice'], platform: 'PC/PS4', icon: 'ğŸ¥·' },
            { name: 'é»‘æš—éˆé­‚3', alias: ['dark souls', 'ds3', 'é»‘é­‚3'], platform: 'PC/PS4', icon: 'ğŸ”¥' },
            { name: 'é»‘æš—éˆé­‚ é‡è£½ç‰ˆ', alias: ['dark souls', 'ds1', 'é»‘é­‚', 'remastered'], platform: 'PC/PS4/Switch', icon: 'â˜€ï¸' },
            { name: 'é­”ç‰©çµäºº å´›èµ·', alias: ['monster hunter', 'mh rise', 'é­”ç‰©', 'å´›èµ·'], platform: 'PC/Switch', icon: 'ğŸ²' },
            { name: 'é­”ç‰©çµäºº å´›èµ·ï¼šç ´æ›‰', alias: ['monster hunter', 'sunbreak', 'ç ´æ›‰'], platform: 'PC/Switch', icon: 'ğŸŒ…' },
            { name: 'é­”ç‰©çµäºº ä¸–ç•Œ', alias: ['monster hunter', 'mhw', 'ä¸–ç•Œ'], platform: 'PC/PS4', icon: 'ğŸŒ' },
            { name: 'é­”ç‰©çµäºº è’é‡', alias: ['monster hunter', 'wilds', 'è’é‡', 'mh wilds'], platform: 'PC/PS5', icon: 'ğŸœï¸' },
            { name: 'åŸç¥', alias: ['genshin', 'genshin impact', 'åŸç¥'], platform: 'PC/PS5/PS4/Mobile', icon: 'â­' },
            { name: 'å´©å£ï¼šæ˜Ÿç©¹éµé“', alias: ['honkai', 'star rail', 'æ˜Ÿéµ', 'å´©éµ'], platform: 'PC/PS5/Mobile', icon: 'ğŸš‚' },
            { name: 'çµ•å€é›¶', alias: ['zenless zone zero', 'zzz', 'çµ•å€é›¶'], platform: 'PC/PS5/Mobile', icon: 'ğŸ“º' },
            { name: 'å·«å¸«3ï¼šç‹‚çµ', alias: ['witcher', 'å·«å¸«', 'wild hunt'], platform: 'PC/PS5/PS4/Switch', icon: 'ğŸº' },
            { name: 'é›»é¦­ä¹˜å®¢2077', alias: ['cyberpunk', 'é›»é¦­', '2077'], platform: 'PC/PS5/PS4', icon: 'ğŸŒ†' },
            { name: 'åšå¾·ä¹‹é–€3', alias: ['baldurs gate', 'bg3', 'åšå¾·ä¹‹é–€'], platform: 'PC/PS5', icon: 'ğŸ­' },
            { name: 'è‰¾çˆ¾æ–‡æˆ°è¨˜', alias: ['armored core', 'ac6', 'æ©Ÿæˆ°å‚­å…µ'], platform: 'PC/PS5/PS4', icon: 'ğŸ¤–' },
            { name: 'æƒ¡éˆå¤å ¡4 é‡è£½ç‰ˆ', alias: ['resident evil', 're4', 'æƒ¡éˆå¤å ¡', 'biohazard'], platform: 'PC/PS5/PS4', icon: 'ğŸ§Ÿ' },
            { name: 'æƒ¡éˆå¤å ¡ æ‘èŠ', alias: ['resident evil', 'village', 'æƒ¡éˆå¤å ¡8'], platform: 'PC/PS5/PS4', icon: 'ğŸ°' },
            { name: 'è–©çˆ¾é”ç„¡é›™ ç½å„å•Ÿç¤ºéŒ„', alias: ['hyrule warriors', 'ç„¡é›™', 'ç½å„'], platform: 'Switch', icon: 'âš”ï¸' },
            { name: 'éœæ ¼è¯èŒ²çš„å‚³æ‰¿', alias: ['hogwarts', 'legacy', 'éœæ ¼è¯èŒ²', 'å“ˆåˆ©æ³¢ç‰¹'], platform: 'PC/PS5/PS4/Switch', icon: 'ğŸ§™' },
            { name: 'è‡¥é¾ï¼šè’¼å¤©éš•è½', alias: ['wo long', 'è‡¥é¾', 'fallen dynasty'], platform: 'PC/PS5/PS4', icon: 'ğŸ‰' },
            { name: 'æµªäººå´›èµ·', alias: ['rise of ronin', 'æµªäºº'], platform: 'PS5', icon: 'â›©ï¸' },
            { name: 'ç‹åœ‹ä¹‹å¿ƒ3', alias: ['kingdom hearts', 'kh3', 'ç‹åœ‹ä¹‹å¿ƒ'], platform: 'PC/PS4', icon: 'ğŸ”‘' },
            { name: 'å°¼çˆ¾ï¼šè‡ªå‹•äººå½¢', alias: ['nier', 'automata', 'å°¼çˆ¾', 'è‡ªå‹•äººå½¢'], platform: 'PC/PS4/Switch', icon: 'ğŸ¤–' },
            { name: 'ä»ç‹2', alias: ['nioh', 'ä»ç‹'], platform: 'PC/PS5/PS4', icon: 'ğŸ‘º' },
            { name: 'æ½›é¾è«œå½±V å¹»ç—›', alias: ['metal gear', 'mgs5', 'æ½›é¾', 'phantom pain'], platform: 'PC/PS4', icon: 'ğŸ“¦' },
            { name: 'åˆºå®¢æ•™æ¢ å¹»è±¡', alias: ['assassins creed', 'mirage', 'åˆºå®¢', 'å¹»è±¡'], platform: 'PC/PS5/PS4', icon: 'ğŸ—¡ï¸' },
            { name: 'åˆºå®¢æ•™æ¢ ç¶­äº¬ç´€å…ƒ', alias: ['assassins creed', 'valhalla', 'åˆºå®¢', 'ç¶­äº¬'], platform: 'PC/PS5/PS4', icon: 'ğŸª“' },
            { name: 'ç¢§è—å¹»æƒ³ Relink', alias: ['granblue', 'relink', 'ç¢§è—å¹»æƒ³'], platform: 'PC/PS5/PS4', icon: 'âœ¨' },
            { name: 'Lies of P', alias: ['lies of p', 'åŒ¹è«¾ä¹”', 'pinocchio'], platform: 'PC/PS5/PS4', icon: 'ğŸ­' },
            { name: 'æš—é»‘ç ´å£ç¥4', alias: ['diablo', 'd4', 'æš—é»‘4'], platform: 'PC/PS5/PS4', icon: 'ğŸ˜ˆ' },
            { name: 'è–„æš®å‚³èªª Remastered', alias: ['tales of', 'vesperia', 'è–„æš®å‚³èªª'], platform: 'PC/PS4/Switch', icon: 'â­' },
            { name: 'ç ´æ›‰å‚³å¥‡', alias: ['tales of arise', 'ç ´æ›‰', 'arise'], platform: 'PC/PS5/PS4', icon: 'ğŸŒ¸' },
            { name: 'å…«æ–¹æ—…äºº2', alias: ['octopath', 'å…«æ–¹æ—…äºº'], platform: 'PC/PS5/PS4/Switch', icon: 'ğŸ­' },
            ];
        }

        // Question templates
        const questionTemplates = {
            'boss': 'è«‹æä¾›è©³ç´°çš„ Boss æˆ°æ”»ç•¥ï¼ŒåŒ…æ‹¬ï¼š\n1. Boss çš„æ”»æ“Šæ¨¡å¼å’Œæ‹›å¼\n2. æ¯å€‹éšæ®µçš„æ‡‰å°ç­–ç•¥\n3. æ¨è–¦çš„è£å‚™å’ŒæŠ€èƒ½\n4. å®‰å…¨çš„è¼¸å‡ºæ™‚æ©Ÿ\n5. éœ€è¦æ³¨æ„çš„è‡´å‘½æ”»æ“Š',
            'hidden': 'è«‹åˆ—å‡ºéŠæˆ²ä¸­çš„éš±è—è¦ç´ ï¼ŒåŒ…æ‹¬ï¼š\n1. éš±è—é“å…·å’Œæ”¶é›†å“çš„ä½ç½®\n2. éš±è—ä»»å‹™çš„è§¸ç™¼æ¢ä»¶\n3. éš±è—å€åŸŸçš„é€²å…¥æ–¹æ³•\n4. éš±è—çµå±€çš„é”æˆæ¢ä»¶',
            'build': 'è«‹æä¾›æœ€å¼·è§’è‰²é…è£å»ºè­°ï¼ŒåŒ…æ‹¬ï¼š\n1. æ¨è–¦çš„æ­¦å™¨å’Œé˜²å…·\n2. æœ€ä½³æŠ€èƒ½æ­é…\n3. å±¬æ€§é»åˆ†é…å»ºè­°\n4. ä¸åŒç©æ³•é¢¨æ ¼çš„é…è£æ–¹æ¡ˆ',
            'quest': 'è«‹æä¾›å®Œæ•´çš„ä¸»ç·š/æ”¯ç·šä»»å‹™æ”»ç•¥æµç¨‹ï¼ŒåŒ…æ‹¬ï¼š\n1. ä»»å‹™é–‹å§‹æ¢ä»¶\n2. è©³ç´°çš„æ­¥é©Ÿèªªæ˜\n3. éœ€è¦æ³¨æ„çš„é¸æ“‡åˆ†æ”¯\n4. ä»»å‹™çå‹µèªªæ˜',
            'tips': 'è«‹æä¾›æ–°æ‰‹å…¥é–€æŒ‡å—ï¼ŒåŒ…æ‹¬ï¼š\n1. éŠæˆ²åŸºæœ¬æ“ä½œèªªæ˜\n2. å‰æœŸç™¼å±•å»ºè­°\n3. å®¹æ˜“å¿½ç•¥çš„é‡è¦æ©Ÿåˆ¶\n4. å¸¸è¦‹æ–°æ‰‹éŒ¯èª¤æé†’\n5. è³‡æºç²å–æŠ€å·§',
            'ending': 'è«‹æä¾›å…¨çµå±€æ”»ç•¥ï¼ŒåŒ…æ‹¬ï¼š\n1. æ‰€æœ‰çµå±€çš„é”æˆæ¢ä»¶\n2. å½±éŸ¿çµå±€çš„é—œéµé¸æ“‡\n3. æ¨è–¦çš„éŠç©é †åº\n4. çœŸçµå±€/éš±è—çµå±€çš„è§£é–æ–¹æ³•'
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            if (!apiKey) {
                setTimeout(() => openModal(), 500);
            }
            document.getElementById('apiKey').value = apiKey;
            
            // Load font size preference
            const savedFontSize = localStorage.getItem('guide_font_size');
            if (savedFontSize !== null) {
                fontSizeLevel = parseInt(savedFontSize);
                updateFontSize();
            }
            
            // Load game database from JSON
            await loadGameDatabase();
            
            // Initialize autocomplete
            initAutocomplete();
        });

        // Autocomplete state
        let autocompleteSelectedIndex = -1;
        let autocompleteResults = [];
        let searchTimeout = null;
        let isSearching = false;

        // Initialize autocomplete
        function initAutocomplete() {
            const input = document.getElementById('gameName');
            const list = document.getElementById('autocompleteList');

            input.addEventListener('input', (e) => {
                const query = e.target.value.trim();
                
                // æ¸…é™¤ä¹‹å‰åµæ¸¬åˆ°çš„å¹³å°ï¼Œç­‰ç”¨æˆ¶é¸æ“‡æ–°éŠæˆ²
                clearDetectedPlatform();
                
                if (query.length < 2) {
                    hideAutocomplete();
                    return;
                }
                
                // Debounce search
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    searchGamesHybrid(query);
                }, 300);
            });

            input.addEventListener('keydown', (e) => {
                if (!list.classList.contains('active')) return;

                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    autocompleteSelectedIndex = Math.min(autocompleteSelectedIndex + 1, autocompleteResults.length - 1);
                    updateAutocompleteSelection();
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    autocompleteSelectedIndex = Math.max(autocompleteSelectedIndex - 1, 0);
                    updateAutocompleteSelection();
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (autocompleteSelectedIndex >= 0 && autocompleteResults[autocompleteSelectedIndex]) {
                        selectGameFromAutocomplete(autocompleteResults[autocompleteSelectedIndex]);
                    }
                } else if (e.key === 'Escape') {
                    hideAutocomplete();
                }
            });

            input.addEventListener('blur', () => {
                setTimeout(hideAutocomplete, 250);
            });

            input.addEventListener('focus', () => {
                const query = input.value.trim();
                if (query.length >= 2) {
                    searchGamesHybrid(query);
                }
            });
        }

        // Hybrid search: Local database + Wikipedia API
        async function searchGamesHybrid(query) {
            const list = document.getElementById('autocompleteList');
            
            // Show loading state
            list.innerHTML = `
                <div class="autocomplete-hint">
                    <span>ğŸ” æœå°‹ä¸­...</span>
                </div>
            `;
            list.classList.add('active');
            
            // First, search local database
            const localResults = searchLocalGames(query);
            
            // Then, search Wikipedia
            let wikiResults = [];
            try {
                wikiResults = await searchWikipediaGames(query);
            } catch (error) {
                console.warn('Wikipedia search failed:', error);
            }
            
            // Merge results (local first, then wiki, remove duplicates)
            const seenNames = new Set(localResults.map(g => g.name.toLowerCase()));
            const mergedResults = [...localResults];
            
            for (const wiki of wikiResults) {
                if (!seenNames.has(wiki.name.toLowerCase())) {
                    mergedResults.push(wiki);
                    seenNames.add(wiki.name.toLowerCase());
                }
                if (mergedResults.length >= 10) break;
            }
            
            showAutocomplete(mergedResults, query);
        }

        // Search local game database
        function searchLocalGames(query) {
            const normalizedQuery = query.toLowerCase();
            
            return gameDatabase.filter(game => {
                // Match game name
                if (game.name.toLowerCase().includes(normalizedQuery)) return true;
                
                // Match aliases
                if (game.alias.some(alias => alias.toLowerCase().includes(normalizedQuery))) return true;
                
                // Fuzzy match - check if all characters appear in order
                const chars = normalizedQuery.split('');
                let nameIndex = 0;
                const nameLower = game.name.toLowerCase();
                for (const char of chars) {
                    const foundIndex = nameLower.indexOf(char, nameIndex);
                    if (foundIndex === -1) return false;
                    nameIndex = foundIndex + 1;
                }
                return true;
            }).slice(0, 5);
        }

        // Search Wikipedia for games
        async function searchWikipediaGames(query) {
            const results = [];
            
            // åŒæ™‚æœå°‹ä¸­æ–‡å’Œè‹±æ–‡ç¶­åŸºç™¾ç§‘
            const searchPromises = [];
            
            // ä¸­æ–‡ç¶­åŸºç™¾ç§‘
            searchPromises.push(
                searchWikipedia(query, 'zh').catch(e => {
                    console.warn('Chinese Wikipedia search failed:', e);
                    return [];
                })
            );
            
            // è‹±æ–‡ç¶­åŸºç™¾ç§‘ï¼ˆå¦‚æœåŒ…å«è‹±æ–‡å­—æ¯æˆ–æ•¸å­—ï¼‰
            if (/[a-zA-Z0-9]/.test(query)) {
                searchPromises.push(
                    searchWikipedia(query, 'en').catch(e => {
                        console.warn('English Wikipedia search failed:', e);
                        return [];
                    })
                );
            }
            
            // æ—¥æ–‡ç¶­åŸºç™¾ç§‘ï¼ˆå¦‚æœåŒ…å«æ—¥æ–‡å­—ç¬¦ï¼‰
            if (/[\u3040-\u309F\u30A0-\u30FF]/.test(query)) {
                searchPromises.push(
                    searchWikipedia(query, 'ja').catch(e => {
                        console.warn('Japanese Wikipedia search failed:', e);
                        return [];
                    })
                );
            }
            
            // ä¸¦è¡Œæœå°‹æ‰€æœ‰ä¾†æº
            const allResults = await Promise.all(searchPromises);
            
            // åˆä½µçµæœä¸¦å»é‡
            const seen = new Set();
            for (const resultSet of allResults) {
                for (const result of resultSet) {
                    const key = result.name.toLowerCase().replace(/\s+/g, '');
                    if (!seen.has(key)) {
                        seen.add(key);
                        results.push(result);
                    }
                }
            }
            
            return results.slice(0, 8);
        }

        // Search Wikipedia API - ä½¿ç”¨å¤šç¨®ç­–ç•¥
        async function searchWikipedia(query, lang = 'zh') {
            const results = [];
            
            // ç­–ç•¥1: ç›´æ¥æœå°‹åŸå§‹æŸ¥è©¢
            try {
                const directResults = await fetchWikipediaSearch(query, lang);
                results.push(...directResults);
            } catch (e) {}
            
            // ç­–ç•¥2: åŠ ä¸ŠéŠæˆ²é—œéµå­—æœå°‹
            if (results.length < 3) {
                try {
                    const gameQuery = lang === 'zh' ? `${query} éŠæˆ²` : `${query} game`;
                    const gameResults = await fetchWikipediaSearch(gameQuery, lang);
                    results.push(...gameResults);
                } catch (e) {}
            }
            
            // å»é‡
            const seen = new Set();
            return results.filter(r => {
                if (seen.has(r.name.toLowerCase())) return false;
                seen.add(r.name.toLowerCase());
                return true;
            }).slice(0, 6);
        }

        // Fetch from Wikipedia OpenSearch API
        async function fetchWikipediaSearch(query, lang) {
            const url = `https://${lang}.wikipedia.org/w/api.php?` + new URLSearchParams({
                action: 'opensearch',
                search: query,
                limit: '10',
                namespace: '0',
                format: 'json',
                origin: '*'
            });
            
            const response = await fetch(url);
            if (!response.ok) throw new Error('Wikipedia API error');
            
            const data = await response.json();
            const [searchTerm, titles, descriptions, urls] = data;
            
            // éŠæˆ²ç›¸é—œé—œéµå­—ï¼ˆæ›´å¯¬é¬†ï¼‰
            const gameKeywords = [
                'éŠæˆ²', 'æ¸¸æˆ', 'game', 'video game', 'é›»å­éŠæˆ²', 'ç”µå­æ¸¸æˆ',
                'playstation', 'ps4', 'ps5', 'ps3', 'xbox', 'switch', 'nintendo', 
                'pc', 'steam', 'windows', 'rpg', 'action', 'adventure',
                'ä»»å¤©å ‚', 'square enix', 'capcom', 'konami', 'bandai', 'sega',
                'fromsoft', 'ubisoft', 'ea', 'activision', 'blizzard',
                'è§’è‰²æ‰®æ¼”', 'å‹•ä½œ', 'å†’éšª', 'ç­–ç•¥', 'å°„æ“Š', 'æ ¼é¬¥', 'è§£è¬',
                'dlc', 'é‡è£½', 'remake', 'remaster', 'edition'
            ];
            
            // æ’é™¤é—œéµå­—ï¼ˆæ›´ç²¾ç¢ºï¼‰
            const strictExcludeKeywords = [
                'é›»å½±', 'å‹•ç•«', 'æ¼«ç•«', 'film', 'movie', 'anime series', 'manga series', 
                'å°èªª', 'novel', 'é›»è¦–åŠ‡', 'tv series', 'television', 'æ­Œæ‰‹', 'singer',
                'æ¼”å“¡', 'actor', 'æ”¿æ²»', 'politician'
            ];
            
            return titles
                .map((title, i) => ({
                    name: cleanGameTitle(title),
                    originalTitle: title,
                    description: descriptions[i] || '',
                    url: urls[i],
                    source: 'wiki',
                    icon: 'ğŸ“–',
                    platform: detectPlatformFromDescription(descriptions[i] || title)
                }))
                .filter((item, i) => {
                    const desc = (descriptions[i] || '').toLowerCase();
                    const title = titles[i].toLowerCase();
                    const combined = desc + ' ' + title;
                    
                    // æª¢æŸ¥æ˜¯å¦æ˜ç¢ºæ’é™¤
                    const isStrictlyExcluded = strictExcludeKeywords.some(kw => {
                        if (combined.includes(kw)) {
                            // ä½†å¦‚æœåŒæ™‚åŒ…å«éŠæˆ²é—œéµå­—ï¼Œå‰‡ä¸æ’é™¤
                            const hasGameKeyword = ['éŠæˆ²', 'game', 'video game'].some(gk => combined.includes(gk));
                            return !hasGameKeyword;
                        }
                        return false;
                    });
                    
                    if (isStrictlyExcluded) return false;
                    
                    // å¯¬é¬†åˆ¤æ–·ï¼šåªè¦åŒ…å«ä»»ä½•éŠæˆ²ç›¸é—œé—œéµå­—å°±ä¿ç•™
                    const isLikelyGame = gameKeywords.some(kw => combined.includes(kw));
                    
                    // æˆ–è€…æ¨™é¡Œæœ¬èº«å°±åƒéŠæˆ²åç¨±ï¼ˆåŒ…å«å¸¸è¦‹éŠæˆ²åç¨±æ ¼å¼ï¼‰
                    const looksLikeGame = /\d/.test(title) || // åŒ…å«æ•¸å­—ï¼ˆå¦‚ FF16, ä»ç‹2ï¼‰
                                          title.includes(':') || // åŒ…å«å†’è™Ÿï¼ˆå¦‚ é»‘ç¥è©±ï¼šæ‚Ÿç©ºï¼‰
                                          title.includes('å‚³èªª') ||
                                          title.includes('ç‰©èª') ||
                                          title.includes('fantasy') ||
                                          title.includes('world') ||
                                          title.includes('saga');
                    
                    return isLikelyGame || looksLikeGame;
                });
        }

        // Clean up Wikipedia title
        function cleanGameTitle(title) {
            // Remove common Wikipedia suffixes
            return title
                .replace(/\s*\(éŠæˆ²\)$/i, '')
                .replace(/\s*\(é›»å­éŠæˆ²\)$/i, '')
                .replace(/\s*\(video game\)$/i, '')
                .replace(/\s*\(game\)$/i, '')
                .replace(/\s*\(\d{4}å¹´éŠæˆ²\)$/i, '')
                .replace(/\s*\(\d{4} video game\)$/i, '')
                .trim();
        }

        // Detect platform from description
        function detectPlatformFromDescription(desc) {
            const descLower = desc.toLowerCase();
            const platforms = [];
            
            if (descLower.includes('nintendo switch') || descLower.includes('switch')) platforms.push('Switch');
            if (descLower.includes('playstation 5') || descLower.includes('ps5')) platforms.push('PS5');
            if (descLower.includes('playstation 4') || descLower.includes('ps4')) platforms.push('PS4');
            if (descLower.includes('pc') || descLower.includes('windows') || descLower.includes('steam')) platforms.push('PC');
            if (descLower.includes('xbox')) platforms.push('Xbox');
            
            return platforms.length > 0 ? platforms.join('/') : 'å¤šå¹³å°';
        }

        // Show autocomplete dropdown
        function showAutocomplete(results, query) {
            const list = document.getElementById('autocompleteList');
            autocompleteResults = results;
            autocompleteSelectedIndex = results.length > 0 ? 0 : -1;

            if (results.length === 0) {
                list.innerHTML = `
                    <div class="autocomplete-hint">
                        <span>ğŸ” æ‰¾ä¸åˆ°ç¬¦åˆçš„éŠæˆ²ï¼Œæ‚¨å¯ä»¥ç›´æ¥è¼¸å…¥å®Œæ•´åç¨±</span>
                    </div>
                `;
            } else {
                const items = results.map((game, index) => `
                    <div class="autocomplete-item ${index === 0 ? 'selected' : ''}" 
                         data-index="${index}"
                         onclick="selectGameFromAutocomplete(autocompleteResults[${index}])">
                        <span class="game-icon">${game.icon}</span>
                        <div class="game-info">
                            <div class="game-name">${highlightMatch(game.name, query)}</div>
                            <div class="game-platform">
                                ${game.platform}
                                ${game.source === 'wiki' ? '<span class="wiki-badge">Wiki</span>' : ''}
                            </div>
                        </div>
                    </div>
                `).join('');

                list.innerHTML = items + `
                    <div class="autocomplete-hint">
                        <span>ğŸ’¡ ä½¿ç”¨ <kbd>â†‘</kbd> <kbd>â†“</kbd> é¸æ“‡ï¼Œ<kbd>Enter</kbd> ç¢ºèªï½œè³‡æ–™ä¾†æºï¼šæœ¬åœ°è³‡æ–™åº« + ç¶­åŸºç™¾ç§‘</span>
                    </div>
                `;
            }

            list.classList.add('active');
        }

        // Highlight matching text
        function highlightMatch(text, query) {
            const lowerText = text.toLowerCase();
            const lowerQuery = query.toLowerCase();
            const index = lowerText.indexOf(lowerQuery);
            
            if (index >= 0) {
                return escapeHtml(text.substring(0, index)) + 
                       '<span class="highlight">' + escapeHtml(text.substring(index, index + query.length)) + '</span>' +
                       escapeHtml(text.substring(index + query.length));
            }
            return escapeHtml(text);
        }

        // Update selection highlight
        function updateAutocompleteSelection() {
            const items = document.querySelectorAll('.autocomplete-item');
            items.forEach((item, index) => {
                item.classList.toggle('selected', index === autocompleteSelectedIndex);
            });
            
            // Scroll into view
            if (items[autocompleteSelectedIndex]) {
                items[autocompleteSelectedIndex].scrollIntoView({ block: 'nearest' });
            }
        }

        // Select game from autocomplete
        function selectGameFromAutocomplete(game) {
            document.getElementById('gameName').value = game.name;
            hideAutocomplete();
            
            const sourceLabel = game.source === 'wiki' ? 'ç¶­åŸºç™¾ç§‘' : 'æœ¬åœ°è³‡æ–™åº«';
            showToast(`âœ… å·²é¸æ“‡ï¼š${game.name}`);
            
            // è‡ªå‹•åµæ¸¬ä¸¦è¨­å®šå¹³å°
            if (game.platform) {
                autoDetectPlatform(game.platform);
            } else {
                clearDetectedPlatform();
            }
        }

        // è‡ªå‹•åµæ¸¬å¹³å°ï¼ˆä¸éœ€è¦æ‰‹å‹•é¸æ“‡ï¼‰
        function autoDetectPlatform(platformStr) {
            if (!platformStr) {
                clearDetectedPlatform();
                return;
            }
            
            const platforms = platformStr.toLowerCase();
            let targetPlatform = null;
            let displayName = platformStr; // é è¨­é¡¯ç¤ºåŸå§‹å­—ä¸²
            
            // å„ªå…ˆé †åºï¼šå¾æ–°åˆ°èˆŠï¼Œå¾ä¸»æµåˆ°æ¬¡è¦
            if (platforms.includes('switch')) {
                targetPlatform = 'switch';
                displayName = 'ğŸ® Nintendo Switch';
            } else if (platforms.includes('ps5')) {
                targetPlatform = 'ps5';
                displayName = 'ğŸ® PlayStation 5';
            } else if (platforms.includes('xbox series') || platforms.includes('xsx')) {
                targetPlatform = 'xbox-series';
                displayName = 'ğŸŸ© Xbox Series X|S';
            } else if (platforms.includes('ps4')) {
                targetPlatform = 'ps4';
                displayName = 'ğŸ¯ PlayStation 4';
            } else if (platforms.includes('xbox one')) {
                targetPlatform = 'xbox-one';
                displayName = 'ğŸŸ¢ Xbox One';
            } else if (platforms.includes('pc') || platforms.includes('steam') || platforms.includes('windows')) {
                targetPlatform = 'pc';
                displayName = 'ğŸ–¥ï¸ PC';
            } else if (platforms.includes('steam deck')) {
                targetPlatform = 'steam-deck';
                displayName = 'ğŸ² Steam Deck';
            } else if (platforms.includes('ios') || platforms.includes('iphone') || platforms.includes('ipad')) {
                targetPlatform = 'ios';
                displayName = 'ğŸ iOS';
            } else if (platforms.includes('android')) {
                targetPlatform = 'android';
                displayName = 'ğŸ¤– Android';
            } else if (platforms.includes('mobile')) {
                targetPlatform = 'mobile';
                displayName = 'ğŸ“± Mobile (iOS/Android)';
            } else if (platforms.includes('3ds') || platforms.includes('ds')) {
                targetPlatform = '3ds';
                displayName = 'ğŸ“± Nintendo 3DS';
            } else if (platforms.includes('gba') || platforms.includes('sfc') || platforms.includes('ps1') || 
                       platforms.includes('ps2') || platforms.includes('gb') || platforms.includes('n64') ||
                       platforms.includes('wii') || platforms.includes('gamecube') || platforms.includes('gc')) {
                targetPlatform = 'retro';
                displayName = 'ğŸ‘¾ ç¶“å…¸ä¸»æ©Ÿ';
            }
            
            // å„²å­˜åµæ¸¬çµæœ
            detectedPlatform = targetPlatform || 'multi';
            detectedPlatformRaw = platformStr;
            
            // æ›´æ–°UIé¡¯ç¤º
            const displayEl = document.getElementById('detectedPlatformDisplay');
            const textEl = document.getElementById('detectedPlatformText');
            
            if (displayEl && textEl) {
                // å¦‚æœæ˜¯å¤šå¹³å°ï¼Œé¡¯ç¤ºæ‰€æœ‰å¹³å°
                if (platformStr.includes('/') || platformStr.includes(',')) {
                    textEl.textContent = platformStr;
                } else {
                    textEl.textContent = displayName;
                }
                displayEl.style.display = 'flex';
            }
        }
        
        // æ¸…é™¤åµæ¸¬çš„å¹³å°
        function clearDetectedPlatform() {
            detectedPlatform = null;
            detectedPlatformRaw = null;
            const displayEl = document.getElementById('detectedPlatformDisplay');
            if (displayEl) {
                displayEl.style.display = 'none';
            }
        }

        // Hide autocomplete
        function hideAutocomplete() {
            document.getElementById('autocompleteList').classList.remove('active');
            autocompleteSelectedIndex = -1;
        }

        // Select popular game (è‡ªå‹•åµæ¸¬å¹³å°)
        function selectGame(gameName) {
            document.getElementById('gameName').value = gameName;
            hideAutocomplete();
            showToast(`âœ… å·²é¸æ“‡ï¼š${gameName}`);
            
            // å¾è³‡æ–™åº«ä¸­æŸ¥æ‰¾éŠæˆ²ä¸¦è‡ªå‹•åµæ¸¬å¹³å°
            const game = gameDatabase.find(g => g.name === gameName);
            if (game && game.platform) {
                autoDetectPlatform(game.platform);
            } else {
                // å¦‚æœæ‰¾ä¸åˆ°ï¼Œæ ¹æ“šéŠæˆ²åç¨±æ™ºèƒ½åˆ¤æ–·
                detectPlatformByGameName(gameName);
            }
        }
        
        // æ ¹æ“šéŠæˆ²åç¨±æ™ºèƒ½åˆ¤æ–·å¹³å°
        function detectPlatformByGameName(gameName) {
            const lowerName = gameName.toLowerCase();
            
            // ä»»å¤©å ‚ç¨ä½”
            if (lowerName.includes('è–©çˆ¾é”') || lowerName.includes('zelda') ||
                lowerName.includes('ç‘ªåˆ©æ­') || lowerName.includes('mario') ||
                lowerName.includes('å¯¶å¯å¤¢') || lowerName.includes('pokemon') ||
                lowerName.includes('æ–¯æ™®æ‹‰é') || lowerName.includes('splatoon') ||
                lowerName.includes('å‹•ç‰©æ£®å‹æœƒ') || lowerName.includes('animal crossing') ||
                lowerName.includes('ç«ç„°ä¹‹ç´‹ç« ') || lowerName.includes('fire emblem') ||
                lowerName.includes('ç•°åº¦ç¥åŠ') || lowerName.includes('xenoblade')) {
                autoDetectPlatform('Switch');
            }
            // PlayStation ç¨ä½”
            else if (lowerName.includes('æˆ°ç¥') || lowerName.includes('god of war') ||
                     lowerName.includes('æœ€å¾Œç”Ÿé‚„è€…') || lowerName.includes('last of us') ||
                     lowerName.includes('èœ˜è››äºº') || lowerName.includes('spider-man') ||
                     lowerName.includes('å°é¦¬') || lowerName.includes('tsushima') ||
                     lowerName.includes('åœ°å¹³ç·š') || lowerName.includes('horizon')) {
                autoDetectPlatform('PS5/PS4');
            }
            // æ‰‹æ©ŸéŠæˆ²å¸¸è¦‹
            else if (lowerName.includes('åŸç¥') || lowerName.includes('genshin') ||
                     lowerName.includes('å´©å£') || lowerName.includes('honkai') ||
                     lowerName.includes('æ˜æ—¥æ–¹èˆŸ') || lowerName.includes('arknights') ||
                     lowerName.includes('ç¥é­”ä¹‹å¡”') ||
                     lowerName.includes('å¯¶å¯å¤¢go') || lowerName.includes('pokemon go')) {
                autoDetectPlatform('iOS/Android');
            }
            // è·¨å¹³å°å¤§ä½œ
            else if (lowerName.includes('è‰¾çˆ¾ç™»') || lowerName.includes('elden ring') ||
                     lowerName.includes('é»‘ç¥è©±') || lowerName.includes('wukong') ||
                     lowerName.includes('é­”ç‰©çµäºº') || lowerName.includes('monster hunter') ||
                     lowerName.includes('æƒ¡éˆå¤å ¡') || lowerName.includes('resident evil')) {
                autoDetectPlatform('PC/PS5/PS4/Xbox');
            }
            else {
                clearDetectedPlatform();
            }
        }

        // Select question template
        function selectTemplate(templateKey) {
            const template = questionTemplates[templateKey];
            if (template) {
                document.getElementById('question').value = template;
                showToast('âœ… å·²å¥—ç”¨å•é¡Œæ¨¡æ¿');
            }
        }

        // Font size control
        function changeFontSize(delta) {
            fontSizeLevel = Math.max(0, Math.min(3, fontSizeLevel + delta));
            updateFontSize();
            localStorage.setItem('guide_font_size', fontSizeLevel);
            showToast(`ğŸ“ å­—é«”å¤§å°ï¼š${['å°', 'ä¸­', 'å¤§', 'ç‰¹å¤§'][fontSizeLevel]}`);
        }

        function updateFontSize() {
            const resultCard = document.getElementById('resultCard');
            if (resultCard) {
                fontSizeClasses.forEach(cls => resultCard.classList.remove(cls));
                resultCard.classList.add(fontSizeClasses[fontSizeLevel]);
            }
        }

        // Platform Selection
        // Modal Functions
        function openModal() {
            document.getElementById('apiModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('apiModal').classList.remove('active');
        }

        function saveApiKey() {
            const key = document.getElementById('apiKey').value.trim();
            if (key) {
                apiKey = key;
                localStorage.setItem('gemini_api_key', key);
                closeModal();
                showToast('âœ… API Key å·²å„²å­˜');
            } else {
                showToast('âŒ è«‹è¼¸å…¥æœ‰æ•ˆçš„ API Key', true);
            }
        }

        // Toast
        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast' + (isError ? ' error' : '');
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Generate Guide
        async function generateGuide() {
            const gameName = document.getElementById('gameName').value.trim();
            const question = document.getElementById('question').value.trim();
            const btn = document.getElementById('generateBtn');

            // Validation
            if (!apiKey) {
                openModal();
                showToast('âŒ è«‹å…ˆè¨­å®š API Key', true);
                return;
            }

            if (!gameName) {
                showToast('âŒ è«‹è¼¸å…¥éŠæˆ²åç¨±', true);
                return;
            }

            if (!question) {
                showToast('âŒ è«‹è¼¸å…¥æ‚¨çš„å•é¡Œ', true);
                return;
            }

            // Update UI
            btn.classList.add('loading');
            btn.textContent = 'ç”Ÿæˆä¸­';
            btn.disabled = true;

            // å–å¾—å¹³å°é¡¯ç¤ºåç¨±ï¼ˆä½¿ç”¨è‡ªå‹•åµæ¸¬çš„å¹³å°æˆ–é¡¯ç¤ºç‚ºå¤šå¹³å°ï¼‰
            let platformDisplayName;
            if (detectedPlatformRaw) {
                // å¦‚æœæœ‰åŸå§‹å¹³å°è³‡æ–™ï¼Œç›´æ¥ä½¿ç”¨
                platformDisplayName = detectedPlatformRaw;
            } else if (detectedPlatform && platformNames[detectedPlatform]) {
                platformDisplayName = platformNames[detectedPlatform];
            } else {
                // æ²’æœ‰åµæ¸¬åˆ°å¹³å°ï¼Œè®“ AI è‡ªè¡Œåˆ¤æ–·
                platformDisplayName = 'å…¨å¹³å°/ç”±AIæ ¹æ“šéŠæˆ²åˆ¤æ–·';
            }

            // Prepare prompt - å¼·èª¿å¿…é ˆæä¾›çœŸå¯¦æº–ç¢ºçš„è³‡è¨Šèˆ‡è©³ç´°æ­¥é©Ÿï¼Œä¸¦ä½¿ç”¨è¡¨æ ¼
            const prompt = `ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„éŠæˆ²æ”»ç•¥å°ˆå®¶ã€‚è«‹æ ¹æ“šç¶²è·¯ä¸Šå¯é çš„éŠæˆ²æ”»ç•¥è³‡æºï¼Œç‚ºä»¥ä¸‹å•é¡Œæä¾›**æº–ç¢ºä¸”ç¶“éé©—è­‰**çš„æ”»ç•¥æŒ‡å—ã€‚

ã€é‡è¦è¦å‰‡ã€‘
- åªæä¾›ä½ èƒ½å¾å¯é ä¾†æºç¢ºèªçš„çœŸå¯¦éŠæˆ²è³‡è¨Š
- å¦‚æœæŸäº›è³‡è¨Šç„¡æ³•ç¢ºèªï¼Œè«‹æ˜ç¢ºæ¨™è¨»ã€Œæ­¤è³‡è¨Šéœ€è¦ç©å®¶è‡ªè¡Œé©—è­‰ã€
- ä¸è¦ç·¨é€ ä¸å­˜åœ¨çš„éŠæˆ²å…§å®¹ã€é“å…·ã€ä»»å‹™æˆ–æ©Ÿåˆ¶
- å„ªå…ˆåƒè€ƒå®˜æ–¹æ”»ç•¥ã€çŸ¥åéŠæˆ²ç¶²ç«™ï¼ˆå¦‚å·´å“ˆå§†ç‰¹ã€IGNã€GameFAQsï¼‰çš„è³‡æ–™

ã€æŸ¥è©¢è³‡è¨Šã€‘
å¹³å°ï¼š${platformDisplayName}
éŠæˆ²ï¼š${gameName}
å•é¡Œï¼š${question}

ã€å›ç­”æ ¼å¼è¦æ±‚ - å¿…é ˆéµå®ˆã€‘

1. **å–„ç”¨è¡¨æ ¼å‘ˆç¾æ•¸æ“š**ï¼šç•¶æ¶‰åŠä»¥ä¸‹æƒ…æ³æ™‚ï¼Œå¿…é ˆä½¿ç”¨ Markdown è¡¨æ ¼æ ¼å¼ï¼š
   - é“å…·/è£å‚™æ¯”è¼ƒï¼ˆåç¨±ã€æ•ˆæœã€å–å¾—æ–¹å¼ï¼‰
   - Boss/æ•µäººè³‡æ–™ï¼ˆHPã€å¼±é»ã€æ‰è½ç‰©ï¼‰
   - ææ–™æ¸…å–®ï¼ˆåç¨±ã€æ•¸é‡ã€ä½ç½®ï¼‰
   - æŠ€èƒ½/å±¬æ€§æ•¸å€¼
   - ä»»å‹™çå‹µ
   
   è¡¨æ ¼ç¯„ä¾‹ï¼š
   | é“å…·åç¨± | æ•ˆæœ | å–å¾—ä½ç½® |
   |---------|------|---------|
   | XXX | YYY | ZZZ |

2. **è©³ç´°æ­¥é©Ÿèªªæ˜**ï¼šå¦‚æœå•é¡Œæ¶‰åŠä»»ä½•æ“ä½œæµç¨‹ï¼ˆå¦‚æ‰“ Bossã€è§£è¬ã€å®Œæˆä»»å‹™ã€å–å¾—é“å…·ç­‰ï¼‰ï¼Œå¿…é ˆæä¾›ç·¨è™Ÿçš„é€æ­¥æŒ‡å—ï¼š
   1. [å…·é«”æ“ä½œ]
   2. [å…·é«”æ“ä½œ]
   3. ä»¥æ­¤é¡æ¨...
   
3. **å‰ç½®æ¢ä»¶**ï¼šä½¿ç”¨è¡¨æ ¼èªªæ˜åŸ·è¡Œå‰éœ€è¦æº–å‚™ä»€éº¼
   | é …ç›® | å»ºè­° |
   |-----|-----|
   | ç­‰ç´š | XX |
   | è£å‚™ | XX |
   | é“å…· | XX |

4. **å…·é«”ä½ç½®**ï¼šå¦‚æ¶‰åŠåœ°é»ï¼Œè«‹èªªæ˜è©³ç´°ä½ç½®ï¼ˆåœ°åœ–åç¨±ã€åº§æ¨™ã€åœ°æ¨™åƒè€ƒï¼‰

5. **æ“ä½œæŠ€å·§**ï¼š
   - æŒ‰éµ/æ‰‹æŠŠæ“ä½œèªªæ˜
   - æ™‚æ©ŸæŠŠæ¡è¦é»
   - å¸¸è¦‹å¤±æ•—åŸå› èˆ‡è§£æ±ºæ–¹æ³•

6. **æ³¨æ„äº‹é …**ï¼š
   - å¯èƒ½é‡åˆ°çš„é™·é˜±æˆ–æ•µäºº
   - æ¨è–¦çš„ç­–ç•¥æˆ–é…è£
   - æ›¿ä»£æ–¹æ¡ˆï¼ˆå¦‚æœæœ‰çš„è©±ï¼‰

è«‹ä½¿ç”¨ç¹é«”ä¸­æ–‡å›ç­”ï¼Œç©æ¥µä½¿ç”¨ Markdown è¡¨æ ¼ä¾†æ•´ç†æ•¸æ“šï¼Œä½¿ç”¨ ## æ¨™é¡Œã€æ•¸å­—åˆ—è¡¨æ­¥é©Ÿã€**ç²—é«”**é‡é»ï¼Œç¢ºä¿å…§å®¹é‡å° ${platformDisplayName} å¹³å°ç‰ˆæœ¬ã€‚`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.3,
                            topK: 20,
                            topP: 0.8,
                            maxOutputTokens: 8192,
                        },
                        tools: [{
                            google_search: {}
                        }]
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error?.message || 'è«‹æ±‚å¤±æ•—');
                }

                const data = await response.json();
                const content = data.candidates?.[0]?.content?.parts?.[0]?.text;
                
                // æå– grounding ä¾†æºè³‡è¨Š
                const groundingMetadata = data.candidates?.[0]?.groundingMetadata;
                const searchSuggestions = groundingMetadata?.webSearchQueries || [];
                const groundingChunks = groundingMetadata?.groundingChunks || [];

                if (!content) {
                    throw new Error('æœªèƒ½ç”Ÿæˆæ”»ç•¥å…§å®¹');
                }

                // Save to conversation history
                currentGameName = gameName;
                currentPlatform = platformDisplayName;
                conversationHistory = [
                    { role: 'user', parts: [{ text: prompt }] },
                    { role: 'model', parts: [{ text: content }] }
                ];

                // Display result with sources
                displayResult(gameName, platformDisplayName, content, groundingChunks);
                showToast('âœ… æ”»ç•¥ç”Ÿæˆå®Œæˆï¼ï¼ˆå·²åƒè€ƒç¶²è·¯è³‡æ–™ï¼‰');

            } catch (error) {
                console.error('Error:', error);
                showToast(`âŒ ${error.message}`, true);
            } finally {
                btn.classList.remove('loading');
                btn.textContent = 'âš¡ ç”Ÿæˆæ”»ç•¥';
                btn.disabled = false;
            }
        }

        // Follow-up question
        async function askFollowup() {
            const followupInput = document.getElementById('followupInput');
            const followupBtn = document.getElementById('followupBtn');
            const followupQuestion = followupInput.value.trim();

            if (!followupQuestion) {
                showToast('âŒ è«‹è¼¸å…¥è¿½å•å…§å®¹', true);
                return;
            }

            if (conversationHistory.length === 0) {
                showToast('âŒ è«‹å…ˆç”Ÿæˆæ”»ç•¥å†è¿½å•', true);
                return;
            }

            // Update UI
            followupBtn.disabled = true;
            followupBtn.textContent = 'â³ å›ç­”ä¸­...';

            const followupPrompt = `ç”¨æˆ¶é‡å°å‰›æ‰çš„ ${currentGameName} (${currentPlatform}) æ”»ç•¥æœ‰è¿½å•ï¼š

${followupQuestion}

è«‹æ ¹æ“šä¹‹å‰çš„æ”»ç•¥å…§å®¹å’Œç¶²è·¯ä¸Šçš„å¯é è³‡è¨Šï¼Œæä¾›æº–ç¢ºçš„è£œå……èªªæ˜ã€‚

æ ¼å¼è¦æ±‚ï¼š
- å¦‚æœæ¶‰åŠæ•¸æ“šæ¯”è¼ƒï¼ˆé“å…·ã€è£å‚™ã€ææ–™ã€æ•µäººè³‡æ–™ç­‰ï¼‰ï¼Œè«‹ä½¿ç”¨ Markdown è¡¨æ ¼æ ¼å¼
- å¦‚æœå•é¡Œæ¶‰åŠæ­¥é©Ÿï¼Œè«‹æä¾›è©³ç´°çš„ç·¨è™Ÿæ­¥é©Ÿ
- ä½¿ç”¨ **ç²—é«”** æ¨™è¨»é‡é»
- ä½¿ç”¨ç¹é«”ä¸­æ–‡å’Œ Markdown æ ¼å¼å›ç­”`;

            try {
                // Build conversation with history
                const contents = [
                    ...conversationHistory,
                    { role: 'user', parts: [{ text: followupPrompt }] }
                ];

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: contents,
                        generationConfig: {
                            temperature: 0.3,
                            topK: 20,
                            topP: 0.8,
                            maxOutputTokens: 8192,
                        },
                        tools: [{
                            google_search: {}
                        }]
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error?.message || 'è«‹æ±‚å¤±æ•—');
                }

                const data = await response.json();
                const content = data.candidates?.[0]?.content?.parts?.[0]?.text;
                const groundingChunks = data.candidates?.[0]?.groundingMetadata?.groundingChunks || [];

                if (!content) {
                    throw new Error('æœªèƒ½ç”Ÿæˆå›ç­”');
                }

                // Update conversation history
                conversationHistory.push(
                    { role: 'user', parts: [{ text: followupPrompt }] },
                    { role: 'model', parts: [{ text: content }] }
                );

                // Append to result
                appendFollowupResult(followupQuestion, content, groundingChunks);
                followupInput.value = '';
                showToast('âœ… è¿½å•å›ç­”å®Œæˆï¼');

            } catch (error) {
                console.error('Error:', error);
                showToast(`âŒ ${error.message}`, true);
            } finally {
                followupBtn.disabled = false;
                followupBtn.textContent = 'ğŸ”„ è¿½å•';
            }
        }

        // Append follow-up result to content
        function appendFollowupResult(question, content, groundingChunks) {
            const resultContent = document.getElementById('resultContent');
            
            let html = `
                <div class="conversation-divider">è¿½å•å›ç­”</div>
                <div class="question-badge">â“ ${escapeHtml(question)}</div>
            `;
            
            html += parseMarkdown(content);
            
            // Add sources if available
            if (groundingChunks.length > 0) {
                html += `<div class="sources-section">
                    <h3>ğŸ“š åƒè€ƒä¾†æº</h3>
                    <ul class="sources-list">`;
                
                const seenUrls = new Set();
                groundingChunks.forEach(chunk => {
                    if (chunk.web && chunk.web.uri && !seenUrls.has(chunk.web.uri)) {
                        seenUrls.add(chunk.web.uri);
                        const title = chunk.web.title || chunk.web.uri;
                        html += `<li><a href="${chunk.web.uri}" target="_blank" rel="noopener">${escapeHtml(title)}</a></li>`;
                    }
                });
                
                html += `</ul></div>`;
            }
            
            resultContent.innerHTML += html;
            
            // Scroll to new content
            resultContent.lastElementChild?.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // è§£æMarkdownè¡¨æ ¼
        function parseMarkdownTables(text) {
            const lines = text.split('\n');
            let result = [];
            let tableLines = [];
            let inTable = false;
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                // æª¢æ¸¬æ˜¯å¦æ˜¯è¡¨æ ¼è¡Œï¼ˆåŒ…å« | ç¬¦è™Ÿï¼‰
                if (line.startsWith('|') && line.endsWith('|')) {
                    inTable = true;
                    tableLines.push(line);
                } else if (inTable && line.match(/^\|[\s\-:|]+\|$/)) {
                    // åˆ†éš”ç·šè¡Œ
                    tableLines.push(line);
                } else {
                    // å¦‚æœä¹‹å‰åœ¨è¡¨æ ¼ä¸­ï¼Œç¾åœ¨çµæŸäº†
                    if (inTable && tableLines.length > 0) {
                        result.push(convertTableToHtml(tableLines));
                        tableLines = [];
                        inTable = false;
                    }
                    result.push(lines[i]);
                }
            }
            
            // è™•ç†æœ€å¾Œçš„è¡¨æ ¼
            if (tableLines.length > 0) {
                result.push(convertTableToHtml(tableLines));
            }
            
            return result.join('\n');
        }

        // å°‡è¡¨æ ¼è¡Œè½‰æ›ç‚ºHTML
        function convertTableToHtml(tableLines) {
            if (tableLines.length < 2) return tableLines.join('\n');
            
            let html = '<table>';
            let isHeader = true;
            let headerProcessed = false;
            
            for (let i = 0; i < tableLines.length; i++) {
                const line = tableLines[i];
                
                // è·³éåˆ†éš”ç·šè¡Œ
                if (line.match(/^\|[\s\-:|]+\|$/)) {
                    if (isHeader) {
                        html += '</thead><tbody>';
                        isHeader = false;
                        headerProcessed = true;
                    }
                    continue;
                }
                
                // è§£æå–®å…ƒæ ¼
                const cells = line.split('|').slice(1, -1).map(cell => cell.trim());
                
                if (isHeader && !headerProcessed) {
                    html += '<thead><tr>';
                    cells.forEach(cell => {
                        // ç‚ºè¡¨é ­æ·»åŠ åœ–æ¨™è£é£¾
                        const icon = getTableHeaderIcon(cell);
                        html += `<th>${icon}${formatTableCell(cell)}</th>`;
                    });
                    html += '</tr>';
                } else {
                    html += '<tr>';
                    cells.forEach((cell, index) => {
                        html += `<td>${formatTableCell(cell)}</td>`;
                    });
                    html += '</tr>';
                }
            }
            
            if (!headerProcessed) {
                html += '</thead><tbody>';
            }
            
            html += '</tbody></table>';
            return html;
        }

        // æ ¼å¼åŒ–è¡¨æ ¼å–®å…ƒæ ¼å…§å®¹
        function formatTableCell(cell) {
            let formatted = cell;
            
            // è™•ç†ç²—é«”
            formatted = formatted.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
            
            // è™•ç†æ•¸å­—ï¼ˆæ·»åŠ ç‰¹æ®Šæ¨£å¼ï¼‰
            formatted = formatted.replace(/^(\d+(?:\.\d+)?(?:[%å€è¬åƒ])?)$/g, '<span class="table-number">$1</span>');
            
            // è™•ç†ç‹€æ…‹æ¨™è¨˜
            formatted = formatted.replace(/^(âœ“|âœ”|â—‹)$/g, '<span class="table-check">$1</span>');
            formatted = formatted.replace(/^(âœ—|âœ˜|Ã—)$/g, '<span class="table-cross">$1</span>');
            
            // è™•ç†è©•ç´šæ˜Ÿæ˜Ÿ
            formatted = formatted.replace(/(â˜…+)/g, '<span class="table-stars">$1</span>');
            formatted = formatted.replace(/(â˜†+)/g, '<span class="table-stars-empty">$1</span>');
            
            return formatted;
        }

        // æ ¹æ“šè¡¨é ­å…§å®¹æ·»åŠ åœ–æ¨™
        function getTableHeaderIcon(headerText) {
            const iconMap = {
                'åç¨±': 'ğŸ“› ', 'åå­—': 'ğŸ“› ', 'name': 'ğŸ“› ',
                'é“å…·': 'ğŸ’ ', 'ç‰©å“': 'ğŸ’ ', 'item': 'ğŸ’ ',
                'ä½ç½®': 'ğŸ“ ', 'åœ°é»': 'ğŸ“ ', 'location': 'ğŸ“ ',
                'æ•ˆæœ': 'âœ¨ ', 'èƒ½åŠ›': 'âœ¨ ', 'effect': 'âœ¨ ',
                'æ•¸é‡': 'ğŸ”¢ ', 'æ•¸å€¼': 'ğŸ”¢ ', 'amount': 'ğŸ”¢ ',
                'ç­‰ç´š': 'ğŸ“Š ', 'level': 'ğŸ“Š ', 'lv': 'ğŸ“Š ',
                'æ”»æ“Š': 'âš”ï¸ ', 'atk': 'âš”ï¸ ', 'attack': 'âš”ï¸ ',
                'é˜²ç¦¦': 'ğŸ›¡ï¸ ', 'def': 'ğŸ›¡ï¸ ', 'defense': 'ğŸ›¡ï¸ ',
                'HP': 'â¤ï¸ ', 'è¡€é‡': 'â¤ï¸ ', 'ç”Ÿå‘½': 'â¤ï¸ ',
                'MP': 'ğŸ’™ ', 'é­”åŠ›': 'ğŸ’™ ', 'æ³•åŠ›': 'ğŸ’™ ',
                'åƒ¹æ ¼': 'ğŸ’° ', 'è²»ç”¨': 'ğŸ’° ', 'price': 'ğŸ’° ',
                'ç¨€æœ‰åº¦': 'ğŸ’ ', 'rarity': 'ğŸ’ ',
                'å±¬æ€§': 'ğŸ”® ', 'type': 'ğŸ”® ', 'element': 'ğŸ”® ',
                'æŠ€èƒ½': 'â­ ', 'skill': 'â­ ',
                'ææ–™': 'ğŸ§± ', 'material': 'ğŸ§± ',
                'æ‰è½': 'ğŸ ', 'drop': 'ğŸ ',
                'èªªæ˜': 'ğŸ“ ', 'æè¿°': 'ğŸ“ ', 'description': 'ğŸ“ ',
                'æ¢ä»¶': 'ğŸ“‹ ', 'condition': 'ğŸ“‹ ',
                'æ™‚é–“': 'â° ', 'time': 'â° ',
                'æ­¥é©Ÿ': 'ğŸ“Œ ', 'step': 'ğŸ“Œ ',
                'é›£åº¦': 'ğŸ¯ ', 'difficulty': 'ğŸ¯ ',
                'çå‹µ': 'ğŸ† ', 'reward': 'ğŸ† ',
                'å‚™è¨»': 'ğŸ“ ', 'note': 'ğŸ“ ',
            };
            
            const lowerText = headerText.toLowerCase();
            for (const [key, icon] of Object.entries(iconMap)) {
                if (lowerText.includes(key.toLowerCase())) {
                    return icon;
                }
            }
            return '';
        }

        // Display Result with sources
        function displayResult(gameName, platform, content, groundingChunks = []) {
            const resultSection = document.getElementById('resultSection');
            const resultTitle = document.getElementById('resultTitle');
            const resultPlatform = document.getElementById('resultPlatform');
            const resultContent = document.getElementById('resultContent');
            const verifiedBadge = document.getElementById('verifiedBadge');

            resultTitle.textContent = `${gameName} æ”»ç•¥`;
            resultPlatform.textContent = platform;
            
            // é¡¯ç¤ºé©—è­‰æ¨™è¨˜
            if (groundingChunks.length > 0) {
                verifiedBadge.style.display = 'inline-flex';
            } else {
                verifiedBadge.style.display = 'none';
            }
            
            // Parse markdown to HTML
            let html = parseMarkdown(content);
            
            // æ·»åŠ åƒè€ƒä¾†æºå€å¡Š
            if (groundingChunks.length > 0) {
                html += `<div class="sources-section">
                    <h3>ğŸ“š åƒè€ƒä¾†æº</h3>
                    <ul class="sources-list">`;
                
                const seenUrls = new Set();
                groundingChunks.forEach(chunk => {
                    if (chunk.web && chunk.web.uri && !seenUrls.has(chunk.web.uri)) {
                        seenUrls.add(chunk.web.uri);
                        const title = chunk.web.title || chunk.web.uri;
                        html += `<li><a href="${chunk.web.uri}" target="_blank" rel="noopener">${title}</a></li>`;
                    }
                });
                
                html += `</ul></div>`;
            }
            
            resultContent.innerHTML = html;
            
            resultSection.style.display = 'block';
            updateFontSize();
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Enhanced Markdown Parser with Table Support
        function parseMarkdown(text) {
            // Escape HTML
            let html = text
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');

            // Code blocks (è™•ç†åœ¨è¡¨æ ¼ä¹‹å‰)
            html = html.replace(/```(\w*)\n([\s\S]*?)```/g, '<pre><code>$2</code></pre>');
            
            // Inline code
            html = html.replace(/`([^`]+)`/g, '<code>$1</code>');

            // è§£æMarkdownè¡¨æ ¼
            html = parseMarkdownTables(html);

            // Headers
            html = html.replace(/^### (.*$)/gm, '<h3>$1</h3>');
            html = html.replace(/^## (.*$)/gm, '<h2>$1</h2>');
            html = html.replace(/^# (.*$)/gm, '<h1>$1</h1>');

            // Bold and Italic
            html = html.replace(/\*\*\*(.+?)\*\*\*/g, '<strong><em>$1</em></strong>');
            html = html.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
            html = html.replace(/\*(.+?)\*/g, '<em>$1</em>');

            // Blockquotes
            html = html.replace(/^> (.*$)/gm, '<blockquote>$1</blockquote>');

            // Unordered lists
            html = html.replace(/^\* (.*$)/gm, '<li>$1</li>');
            html = html.replace(/^- (.*$)/gm, '<li>$1</li>');
            html = html.replace(/^â€¢ (.*$)/gm, '<li>$1</li>');

            // Ordered lists
            html = html.replace(/^\d+\. (.*$)/gm, '<li>$1</li>');

            // Wrap consecutive li elements in ul
            html = html.replace(/(<li>.*<\/li>\n?)+/g, '<ul>$&</ul>');

            // Line breaks
            html = html.replace(/\n\n/g, '</p><p>');
            html = html.replace(/\n/g, '<br>');

            // Wrap in paragraph
            html = '<p>' + html + '</p>';

            // Clean up
            html = html.replace(/<p><\/p>/g, '');
            
            // æ¸…ç†è¡¨æ ¼å‘¨åœå¤šé¤˜çš„æ¨™ç±¤
            html = html.replace(/<p>(<table[\s\S]*?<\/table>)<\/p>/g, '$1');
            html = html.replace(/<br>(<table)/g, '$1');
            html = html.replace(/(<\/table>)<br>/g, '$1');
            html = html.replace(/<p>(<h[1-3]>)/g, '$1');
            html = html.replace(/(<\/h[1-3]>)<\/p>/g, '$1');
            html = html.replace(/<p>(<ul>)/g, '$1');
            html = html.replace(/(<\/ul>)<\/p>/g, '$1');
            html = html.replace(/<p>(<pre>)/g, '$1');
            html = html.replace(/(<\/pre>)<\/p>/g, '$1');
            html = html.replace(/<p>(<blockquote>)/g, '$1');
            html = html.replace(/(<\/blockquote>)<\/p>/g, '$1');
            html = html.replace(/<br><\/p>/g, '</p>');
            html = html.replace(/<p><br>/g, '<p>');

            return html;
        }

        // Copy Result
        function copyResult() {
            const content = document.getElementById('resultContent').innerText;
            navigator.clipboard.writeText(content).then(() => {
                showToast('âœ… å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿');
            }).catch(() => {
                showToast('âŒ è¤‡è£½å¤±æ•—', true);
            });
        }

        // Close modal on outside click
        document.getElementById('apiModal').addEventListener('click', (e) => {
            if (e.target.id === 'apiModal') {
                closeModal();
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
            }
            if (e.key === 'Enter' && e.ctrlKey) {
                generateGuide();
            }
        });
    </script>
</body>
</html>
